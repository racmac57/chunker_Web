REM ðŸ•’ 2025-06-28-01-15-30
REM chunker/build_and_run.bat
REM Author: R. A. Carucci
REM Purpose: One-click build and launch script for chunker executable

@echo off
cd /d "%~dp0"

echo =====================================
echo  Chunker Build and Launch Script
echo =====================================
echo.

REM Check if Python is available
python --version >nul 2>&1
if errorlevel 1 (
    echo ERROR: Python not found in PATH
    echo Please install Python or activate conda environment
    pause
    exit /b 1
)

REM Check if PyInstaller is available
pyinstaller --version >nul 2>&1
if errorlevel 1 (
    echo Installing PyInstaller...
    pip install pyinstaller
    if errorlevel 1 (
        echo ERROR: Failed to install PyInstaller
        pause
        exit /b 1
    )
)

REM Clean previous build
if exist "dist" (
    echo Cleaning previous build...
    rmdir /s /q "dist"
)
if exist "build" (
    rmdir /s /q "build"
)

echo.
echo Building executable from chunker_hidden.spec...
pyinstaller chunker_hidden.spec

if errorlevel 1 (
    echo.
    echo ERROR: Build failed!
    echo Check the output above for errors
    pause
    exit /b 1
)

echo.
echo Build completed successfully!
echo.

REM Check if executable was created
if not exist "dist\chunker_hidden.exe" (
    echo ERROR: Executable not found at dist\chunker_hidden.exe
    pause
    exit /b 1
)

echo Launching chunker in background...
start "" "dist\chunker_hidden.exe"

echo.
echo =====================================
echo  Chunker Started Successfully!
echo =====================================
echo.
echo The chunker is now running in background.
echo Monitor status with:
echo   .\test_chunker.ps1 -MonitorOnly
echo.
echo Check results with:
echo   .\test_chunker.ps1 -CheckResults
echo.
echo To stop the chunker:
echo   Use Task Manager to end chunker_hidden.exe
echo.
pause