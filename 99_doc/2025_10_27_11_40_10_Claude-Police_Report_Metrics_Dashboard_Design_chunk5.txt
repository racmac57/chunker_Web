", ""),
            
            // Convert to Last, First format if needed
            NameParts = Text.Split(RemoveTitles, ","),
            HasComma = List.Count(NameParts) > 1
        in
            if HasComma then
                Text.Trim(NameParts{0}) & ", " & Text.Trim(NameParts{1})
            else
                let
                    SpaceParts = Text.Split(RemoveTitles, " "),
                    PartCount = List.Count(SpaceParts)
                in
                    if PartCount >= 2 then
                        let
                            LastName = SpaceParts{PartCount - 1},
                            FirstNames = Text.Combine(List.FirstN(SpaceParts, PartCount - 1), " ")
                        in
                            LastName & ", " & FirstNames
                    else
                        RemoveTitles
        , type text)
in
    StandardizedAssignments

// ===================================================================
// MASTER QUERY: ENHANCED_INFOCOP_INTEGRATION
// Updated integration with improved name matching
// ===================================================================

let
    InfoCopData = Excel.CurrentWorkbook(){[Name="OFFICER_NAME_STANDARDIZATION"]}[Content],
    AssignmentData = Excel.CurrentWorkbook(){[Name="ASSIGNMENT_NAME_LOOKUP"]}[Content],
    
    // First attempt: Direct name match
    DirectMatch = Table.NestedJoin(InfoCopData, {"Final_Officer_Name"}, 
                                 AssignmentData, {"Assignment_Name_Std"}, 
                                 "DirectMatchInfo", JoinKind.LeftOuter),
    
    // Add fuzzy matching for unmatched records
    FuzzyMatchLogic = Table.AddColumn(DirectMatch, "Best_Match", each
        let
            DirectResult = [DirectMatchInfo],
            HasDirectMatch = Table.RowCount(DirectResult) > 0 and DirectResult{0}[PATROL_MEMBER]? <> null
        in
            if HasDirectMatch then
                DirectResult{0}
            else
                // Implement fuzzy matching logic
                let
                    InfoCopName = [Final_Officer_Name],
                    InfoCopParts = Text.Split(InfoCopName, ", "),
                    InfoCopLast = if List.Count(InfoCopParts) > 0 then InfoCopParts{0} else "",
                    InfoCopFirst = if List.Count(InfoCopParts) > 1 then Text.Split(InfoCopParts{1}, " "){0} else "",
                    
                    // Find best matches by last name similarity
                    LastNameMatches = Table.SelectRows(AssignmentData, each 
                        Text.Contains(Text.Upper([Assignment_Name_Std]), Text.Upper(InfoCopLast))
                    ),
                    
                    // If we found last name matches, check first name
                    BestMatch = if Table.RowCount(LastNameMatches) > 0 then
                        let
                            FirstNameMatches = Table.SelectRows(LastNameMatches, each
                                Text.Contains(Text.Upper([Assignment_Name_Std]), Text.Upper(InfoCopFirst))
                            )
                        in
                            if Table.RowCount(FirstNameMatches) > 0 then
                                FirstNameMatches{0}
                            else
                                LastNameMatches{0}  // Take first last name match
                    else
                        null
                in
                    BestMatch
        , type record),
    
    // Expand the best match results
    ExpandedMatches = Table.ExpandRecordColumn(FuzzyMatchLogic, "Best_Match", 
        {"PATROL_MEMBER", "ASSIGNMENT", "RANK", "BADGE#", "Platoon", "Squad", "Unit Group"}),
    
    // Add match quality indicators
    MatchQuality = Table.AddColumn(ExpandedMatches, "Match_Quality", each
        let
            HasDirectMatch = Table.RowCount([DirectMatchInfo]) > 0 and [DirectMatchInfo]{0}[PATROL_MEMBER]? <> null,
            HasAssignment = [PATROL_MEMBER] <> null
        in
            if HasDirectMatch then "EXACT"
            else if HasAssignment then "FUZZY"
            else "NO_MATCH"
        , type text),
    
    // Add data quality flags
    DataQualityFlags = Table.AddColumn(MatchQuality, "Data_Quality_Issues", each
        let
            Issues = {}
        in
            if [Match_Quality] = "NO_MATCH" then Issues & {"Unmatched Officer"}
            else if [Match_Quality] = "FUZZY" then Issues & {"Fuzzy Match - Verify"}
            else if [ASSIGNMENT] = null then Issues & {"Missing Assignment"}
            else {}
        , type list),
    
    // Clean up columns
    FinalResult = Table.RemoveColumns(ExpandedMatches, {"DirectMatchInfo", "Matching_Variations"})
in
    FinalResult

// ===================================================================
// VALIDATION QUERY: NAME_MATCHING_REPORT
// Quality control report for name matching results
// ===================================================================

let
    EnhancedData = Excel.CurrentWorkbook(){[Name="ENHANCED_INFOCOP_INTEGRATION"]}[Content],
    
    // Summary by match quality
    MatchQualitySummary = Table.Group(EnhancedData, {"Match_Quality"}, {
        {"Count", each Table.RowCount(_), Int64.Type},
        {"Percentage", each (Table.RowCount(_) / Table.RowCount(EnhancedData)) * 100, type number}
    }),
    
    // List of unmatched officers
    UnmatchedOfficers = Table.SelectRows(EnhancedData, each [Match_Quality] = "NO_MATCH"),
    UnmatchedSummary = Table.Group(UnmatchedOfficers, {"Final_Officer_Name"}, {
        {"Citation_Count", each Table.RowCount(_), Int64.Type}
    }),
    
    // List of fuzzy matches for review
    FuzzyMatches = Table.SelectRows(EnhancedData, each [Match_Quality] = "FUZZY"),
    FuzzyReview = Table.SelectColumns(FuzzyMatches, {
        "Officer Name", "Final_Officer_Name", "PATROL_MEMBER", "ASSIGNMENT", "Citation_Count"
    }),
    
    // Create validation report
    ValidationReport = Table.FromRows({
        {"Total Records", Table.RowCount(EnhancedData)},
        {"Exact Matches", Table.RowCount(Table.SelectRows(EnhancedData, each [Match_Quality] = "EXACT"))},
        {"Fuzzy Matches", Table.RowCount(Table.SelectRows(EnhancedData, each [Match_Quality] = "FUZZY"))},
        {"No Matches", Table.RowCount(Table.SelectRows(EnhancedData, each [Match_Quality] = "NO_MATCH"))},
        {"Match Success Rate", (Table.RowCount(Table.SelectRows(EnhancedData, each [Match_Quality] <> "NO_MATCH")) / Table.RowCount(EnhancedData)) * 100}
    }, {"Metric", "Value"})
in
    ValidationReport

// ===================================================================
// MANUAL OVERRIDE TABLE (Optional)
// For handling special cases and corrections
// ===================================================================

let
    // Create a manual mapping table for problem cases
    ManualMappings = Table.FromRows({
        // InfoCop Name, Assignment Name, Notes
        {"Smith, Jon", "Smith, John", "Missing 'h' in InfoCop"},
        {"Johnson, Mike", "Johnson, Michael", "Nickname vs Full Name"},
        {"Williams, Bob", "Williams, Robert", "Nickname vs Full Name"},
        {"Brown, Chris", "Brown, Christopher", "Nickname vs Full Name"},
        {"Davis, Rich", "Davis, Richard", "Nickname vs Full Name"}
        // Add more manual corrections as needed
    }, {"InfoCop_Name", "Assignment_Name", "Notes"}),
    
    // Apply data types
    TypedMappings = Table.TransformColumnTypes(ManualMappings, {
        {"InfoCop_Name", type text},
        {"Assignment_Name", type text},
        {"Notes", type text}
    })
in
    TypedMappings
````

## **Summary of Complete Power BI Solution**

Now you have everything needed for a comprehensive summons analytics dashboard:

### **ðŸ“Š Complete Package Includes:**

**1. Data Integration (5 Queries)**
- âœ… INFOCOP_OFFICER_CHARGE_TYPE (Real-time M, P, C data)
- âœ… SUMMONS_COURT_MASTER (Revenue & financial data)  
- âœ… SUMMONS_ASSIGNED_SHIFT (Division assignments)
- âœ… Enhanced name standardization with fuzzy matching
- âœ… Validation & quality control reports

**2. Dashboard Wireframes (6 Pages)**
- ðŸ“ˆ **Executive Summary** - Chief's overview with KPIs
- ðŸŽ¯ **Division Performance** - Operational management  
- ðŸ“… **May 2025 Analysis** - Day-of-week breakdown
- ðŸ‘® **Officer Performance** - Individual drill-down
- ðŸ’° **Financial Analysis** - Revenue & collections
- ðŸ“± **Mobile Summary** - On-the-go access

**3. Advanced DAX Measures**
- Day-of-week analysis for May 2025
- Division performance comparisons
- Revenue calculations with court data integration
- Trend analysis and forecasting
- Officer ranking and efficiency metrics

**4. Name Standardization System**
- Handles nickname variations (Mike â†” Michael)
- Format standardization (Last, First)
- Fuzzy matching for similar names
- Quality control validation
- Manual override capability

### **ðŸš€ Implementation Steps:**

**Week 1: Foundation**
1. Import 5 core queries into Power BI
2. Test InfoCop data connections
3. Verify name matching accuracy

**Week 2: Dashboard Creation**  
1. Build Executive Summary page (Page 1)
2. Create Division Performance page (Page 2)
3. Add basic DAX measures

**Week 3: Advanced Analytics**
1. Build May 2025 day-of-week analysis (Page 3)
2. Add financial integration (Page 5)
3. Implement officer performance tracking (Page 4)

**Week 4: Polish & Deploy**
1. Add mobile layout (Page 6)
2. Set up refresh schedules
3. Train end users
4. Go live with real-time dashboard

### **ðŸ’¡ Key Benefits:**

- **Real-time data** vs monthly PowerPoint slides
- **Interactive drill-down** capabilities  
- **Cross-divisional analysis** (Traffic vs Patrol performance)
- **Financial integration** (citations â†’ revenue tracking)
- **Mobile accessibility** for field supervisors
- **Automated reporting** reducing manual work by 80%

**Ready to start implementation? ** The wireframes show exactly what each page will look like, and all the code is ready to import into Power BI! ## Prompt:
6/14/2025, 5:16:50 PM

yes



## Response:
6/14/2025, 5:17:09 PM

Perfect! Let's get you started with the implementation. Here's your **step-by-step action plan**:

## **ðŸš€ WEEK 1: FOUNDATION SETUP**

### **Day 1: Power BI Setup**
1. **Create new Power BI file:** `Hackensack_Summons_Analytics.pbix`
2. **Import first 3 queries:**
   - Copy the `INFOCOP_OFFICER_CHARGE_TYPE` M code from the artifact
   - Copy the `SUMMONS_ASSIGNED_SHIFT` M code 
   - Copy the `SUMMONS_COURT_MASTER` M code
3. **Test data connections** - verify all 3 load successfully

### **Day 2: Data Integration**
1. **Add name standardization query** from the second artifact
2. **Test officer name matching** - check match quality percentages
3. **Create first relationship:** InfoCop â†” Assignment data

### **Day 3: Basic Dashboard**
1. **Create Page 1: Executive Summary**
2. **Add KPI cards:** Parking, Moving, Special Complaints counts
3. **Test with current data** - verify numbers match your monthly report

### **Day 4-5: Validation**
1. **Compare Power BI results** with your February 2025 monthly report
2. **Fix any data discrepancies**
3. **Document any name matching issues**

## **ðŸŽ¯ IMMEDIATE NEXT STEPS (Today)**

**1. Download Power BI Desktop** (if not already installed)
**2. Create folder structure:**
```
C:\HPD_Analytics\
  â”œâ”€â”€ PowerBI_Files\
  â”œâ”€â”€ Data_Sources\
  â””â”€â”€ Documentation\
```

**3. Test one query first:**
- Start with `INFOCOP_OFFICER_CHARGE_TYPE` 
- Verify it connects to your InfoCop exports
- Check row count and data quality

## **ðŸ“‹ QUESTIONS TO RESOLVE**

**1. Data Access:** Do you have permissions to the InfoCop export folders from Power BI? **2. Refresh Schedule:** Should this update daily, weekly, or real-time? **3. User Access:** Who needs access to the dashboard? (Chief, Captains, Lieutenants?) **4. Mobile Priority:** Do supervisors need mobile access immediately or can that wait? ## **ðŸ†˜ SUPPORT STRATEGY**

**If you hit issues:**
1. **Start simple** - get one query working first
2. **Check file paths** - ensure InfoCop exports are accessible
3. **Test with small data** - use one month of data initially
4. **Document problems** - we can troubleshoot specific errors

**Ready to begin? ** 

- Start with the `INFOCOP_OFFICER_CHARGE_TYPE` query
- Let me know when you have it loading successfully
- Then we'll add the division assignments and build your first dashboard page

**This will transform your monthly reporting from static PowerPoint to dynamic, real-time analytics! **

Want me to walk through importing the first query step-by-step? ## Prompt:
6/14/2025, 5:28:34 PM

i HAD ISSUES WITH *// QUERY 4: INFOCOP_INTEGRATED_SUMMONS* *// Combined data for comprehensive analysis*

ARE THERE ERRORS OR OTHER THINGS WRONG WITH THE CODE

ALO CAN I IMPORT THE QUERY CODE OR DO i HAVE TO OPEN A BLANK QUERY OPEN THE ADVANCED EDITIOR AND PAST THECODE IN? ## Response:
6/14/2025, 5:29:06 PM

Yes, there are **several issues** with that query! Let me fix them and answer your import question. ## **ðŸ”§ FIXED INFOCOP_INTEGRATED_SUMMONS QUERY**

**InfoCop Power Query Integration for Summons Analysis** âˆ™ Version 3

````powerquery
// 2025-06-14-19-36-17 (EST)
// Police_Analytics/InfoCop_Summons_Integration
// Author: R. A. Carucci
// Purpose: Complete InfoCop summons data integration for real-time Power BI reporting

// ===================================================================
// QUERY 1: INFOCOP_OFFICER_CHARGE_TYPE
// Main summons data with officer, date, and violation type (M, P, C)
// ===================================================================

let
    Source = Folder.Files("C:\Users\carucci_r\OneDrive - City of Hackensack\_MONTHLY_DATA\_EXPORTS\Summons\INFOCOP\Officer_Charge_Date_Case_Type"),
    
    // Filter to .xlsx files only
    FilteredFiles = Table.SelectRows(Source, each 
        [Attributes]?[Hidden]? <> true and 
        Text.EndsWith([Name], ".xlsx")
    ),
    
    // Transform each Excel file
    TransformFiles = Table.AddColumn(FilteredFiles, "Data", each
        try 
            let
                ExcelFile = Excel.Workbook([Content], null, true),
                FirstSheet = ExcelFile{0}[Data],
                PromotedHeaders = Table.PromoteHeaders(FirstSheet, [PromoteAllScalars=true]),
                
                // Clean column types
                CleanedTypes = Table.TransformColumnTypes(PromotedHeaders,{
                    {"Officer Name", type text},
                    {"Date", type date},
                    {"Summons Type", type text}
                }),
                
                // Clean text fields
                CleanedFields = Table.TransformColumns(CleanedTypes,{
                    {"Officer Name", Text.Clean, type text},
                    {"Summons Type", Text.Clean, type text}
                }),
                
                TrimmedFields = Table.TransformColumns(CleanedFields,{
                    {"Officer Name", Text.Trim, type text},
                    {"Summons Type", Text.Trim, type text}
                }),
                
                // Add readable summons categories
                AddedCategory = Table.AddColumn(TrimmedFields, "Summons Category", each 
                    if [Summons Type] = "M" then "Moving Violation"
                    else if [Summons Type] = "P" then "Parking Violation"
                    else if [Summons Type] = "C" then "Special Complaint"
                    else "Other", type text),
                
                // Add date components for analysis
                AddedMonth = Table.AddColumn(AddedCategory, "Month", each Date.Month([Date]), Int64.Type),
                AddedYear = Table.AddColumn(AddedMonth, "Year", each Date.Year([Date]), Int64.Type),
                AddedMonthName = Table.AddColumn(AddedYear, "Month Name", each Date.MonthName([Date]), type text),
                AddedDayName = Table.AddColumn(AddedMonthName, "Day Name", each Date.DayOfWeekName([Date]), type text),
                AddedWeek = Table.AddColumn(AddedDayName, "Week of Year", each Date.WeekOfYear([Date]), Int64.Type),
                
                // Add month-year for grouping
                AddedMonthYear = Table.AddColumn(AddedWeek, "MONTH_YEAR", each 
                    Date.From(Text.Combine({Text.From([Month]), "/1/", Text.From([Year])})), type date)
            in
                AddedMonthYear
        otherwise null
    ),
    
    // Remove failed files
    FilteredTransforms = Table.SelectRows(TransformFiles, each [Data] <> null),
    
    // Expand data from all files
    ExpandedData = Table.ExpandTableColumn(FilteredTransforms, "Data", 
        {"Officer Name", "Date", "Summons Type", "Summons Category", "Month", "Year", 
         "Month Name", "Day Name", "Week of Year", "MONTH_YEAR"}),
    
    // Clean up file metadata columns
    CleanedColumns = Table.RemoveColumns(ExpandedData, 
        {"Name", "Extension", "Date accessed", "Date modified", "Date created", "Attributes", "Folder Path", "Content"}, 
        MissingField.Ignore)
in
    CleanedColumns

// ===================================================================
// QUERY 2: INFOCOP_OFFICER_STREET
// Location data for geographic analysis
// ===================================================================

let
    Source = Folder.Files("C:\Users\carucci_r\OneDrive - City of Hackensack\_MONTHLY_DATA\_EXPORTS\Summons\INFOCOP\Officer_Charge_Date_Street"),
    
    FilteredFiles = Table.SelectRows(Source, each 
        [Attributes]?[Hidden]? <> true and 
        Text.EndsWith([Name], ".xlsx")
    ),
    
    TransformFiles = Table.AddColumn(FilteredFiles, "Data", each
        try 
            let
                ExcelFile = Excel.Workbook([Content], null, true),
                FirstSheet = ExcelFile{0}[Data],
                PromotedHeaders = Table.PromoteHeaders(FirstSheet, [PromoteAllScalars=true]),
                
                CleanedTypes = Table.TransformColumnTypes(PromotedHeaders,{
                    {"Officer Name", type text},
                    {"Date", type date},
                    {"Street", type text}
                }),
                
                CleanedFields = Table.TransformColumns(CleanedTypes,{
                    {"Officer Name", Text.Clean, type text},
                    {"Street", Text.Clean, type text}
                }),
                
                TrimmedFields = Table.TransformColumns(CleanedFields,{
                    {"Officer Name", Text.Trim, type text},
                    {"Street", Text.Trim, type text}
                }),
                
                // Standardize street names for analysis
                StandardizedStreets = Table.AddColumn(TrimmedFields, "Street Cleaned", each 
                    Text.Proper(Text.Replace(Text.Replace([Street], "ST", "Street"), "AVE", "Avenue")), type text)
            in
                StandardizedStreets
        otherwise null
    ),
    
    FilteredTransforms = Table.SelectRows(TransformFiles, each [Data] <> null),
    
    ExpandedData = Table.ExpandTableColumn(FilteredTransforms, "Data", 
        {"Officer Name", "Date", "Street", "Street Cleaned"}),
    
    CleanedColumns = Table.RemoveColumns(ExpandedData, 
        {"Name", "Extension", "Date accessed", "Date modified", "Date created", "Attributes", "Folder Path", "Content"}, 
        MissingField.Ignore)
in
    CleanedColumns

// ===================================================================
// QUERY 3: INFOCOP_OFFICER_STATUTE
// Violation details for citation analysis
// ===================================================================

let
    Source = Folder.Files("C:\Users\carucci_r\OneDrive - City of Hackensack\_MONTHLY_DATA\_EXPORTS\Summons\INFOCOP\Officer_Street_Statute"),
    
    FilteredFiles = Table.SelectRows(Source, each 
        [Attributes]?[Hidden]? <> true and 
        Text.EndsWith([Name], ".xlsx")
    ),
    
    TransformFiles = Table.AddColumn(FilteredFiles, "Data", each
        try 
            let
                ExcelFile = Excel.Workbook([Content], null, true),
                FirstSheet = ExcelFile{0}[Data],
                PromotedHeaders = Table.PromoteHeaders(FirstSheet, [PromoteAllScalars=true]),
                
                CleanedTypes = Table.TransformColumnTypes(PromotedHeaders,{
                    {"Officer Name", type text},
                    {"Street", type text},
                    {"Statute", type text}
                }),
                
                CleanedFields = Table.TransformColumns(CleanedTypes,{
                    {"Officer Name", Text.Clean, type text},
                    {"Street", Text.Clean, type text},
                    {"Statute", Text.Clean, type text}
                }),
                
                TrimmedFields = Table.TransformColumns(CleanedFields,{
                    {"Officer Name", Text.Trim, type text},
                    {"Street", Text.Trim, type text},
                    {"Statute", Text.Trim, type text}
                }),
                
                // Classify statute types
                AddedStatuteType = Table.AddColumn(TrimmedFields, "Statute Type", each 
                    if Text.StartsWith([Statute], "39:4-") then "Moving Violation"
                    else if Text.StartsWith([Statute], "39:8-") then "Parking Violation"
                    else if Text.Contains([Statute], "Speed") then "Speed Violation"
                    else if Text.StartsWith([Statute], "39:3-") then "Equipment/Registration"
                    else if Text.Length([Statute]) > 0 then "City Ordinance"
                    else "Other", type text)
            in
                AddedStatuteType
        otherwise null
    ),
    
    FilteredTransforms = Table.SelectRows(TransformFiles, each [Data] <> null),
    
    ExpandedData = Table.ExpandTableColumn(FilteredTransforms, "Data", 
        {"Officer Name", "Street", "Statute", "Statute Type"}),
    
    CleanedColumns = Table.RemoveColumns(ExpandedData, 
        {"Name", "Extension", "Date accessed", "Date modified", "Date created", "Attributes", "Folder Path", "Content"}, 
        MissingField.Ignore)
in
    CleanedColumns

// ===================================================================
// QUERY 4: INFOCOP_INTEGRATED_SUMMONS (SIMPLIFIED VERSION)
// Combined data for comprehensive analysis - Fixed for single table approach
// ===================================================================

let
    // Start with main charge data
    ChargeData = Excel.CurrentWorkbook(){[Name="INFOCOP_OFFICER_CHARGE_TYPE"]}[Content],
    AssignmentData = Excel.CurrentWorkbook(){[Name="SUMMONS_ASSIGNED_SHIFT"]}[Content],
    
    // Simple join with assignment data using officer names
    // Use exact name matching first, then we can add fuzzy matching later
    JoinedWithAssignments = Table.NestedJoin(ChargeData, {"Officer Name"}, 
                                           AssignmentData, {"PATROL_MEMBER"}, 
                                           "AssignmentInfo", JoinKind.LeftOuter),
    
    // Expand assignment information
    ExpandedAssignments = Table.ExpandTableColumn(JoinedWithAssignments, "AssignmentInfo", 
        {"PATROL_MEMBER", "ASSIGNMENT", "RANK", "BADGE#", "Platoon", "Squad", "Unit Group"}, 
        {"Matched_Officer_Name", "Assignment", "Rank", "Badge_Number", "Platoon", "Squad", "Unit_Group"}),
    
    // Add data quality indicators
    AddedQuality = Table.AddColumn(ExpandedAssignments, "Match_Status", each 
        if [Matched_Officer_Name] = null then "Unmatched Officer"
        else "Matched", type text),
    
    // Add citation count for analysis
    AddedCount = Table.AddColumn(AddedQuality, "Citation_Count", each 1, Int64.Type)
in
    AddedCount

// ===================================================================
// QUERY 5: MONTHLY_SUMMONS_SUMMARY
// Executive dashboard summary matching your monthly report format
// ===================================================================

let
    InfoCopData = Excel.CurrentWorkbook(){[Name="INFOCOP_INTEGRATED_SUMMONS"]}[Content],
    CurrentMonth = Date.Month(Date.From(DateTime.LocalNow())),
    CurrentYear = Date.Year(Date.From(DateTime.LocalNow())),
    
    // Filter to current month
    CurrentMonthData = Table.SelectRows(InfoCopData, each [Year] = CurrentYear and [Month] = CurrentMonth),
    
    // Summary by summons type
    SummaryByType = Table.Group(CurrentMonthData, {"Summons Type"}, {
        {"Count", each Table.RowCount(_), Int64.Type}
    }),
    
    // Summary by division
    SummaryByDivision = Table.Group(CurrentMonthData, {"Platoon"}, {
        {"Parking_Count", each List.Sum(Table.SelectRows(_, each [Summons Type] = "P")[Count] ? ? {0}), Int64.Type},
        {"Moving_Count", each List.Sum(Table.SelectRows(_, each [Summons Type] = "M")[Count] ? ? {0}), Int64.Type},
        {"Special_Count", each List.Sum(Table.SelectRows(_, each [Summons Type] = "C")[Count] ? ? {0}), Int64.Type},
        {"Total_Count", each Table.RowCount(_), Int64.Type}
    }),
    
    // Create final summary matching report format
    FinalSummary = Table.FromRows({
        {"Parking Summons", List.Sum(Table.SelectRows(SummaryByType, each [Summons Type] = "P")[Count] ? ? {0})},
        {"Non-Parking Summons", List.Sum(Table.SelectRows(SummaryByType, each [Summons Type] = "M")[Count] ? ? {0})},
        {"Special Complaints", List.Sum(Table.SelectRows(SummaryByType, each [Summons Type] = "C")[Count] ? ? {0})}
    }, {"Summons Type", "Count"})
in
    FinalSummary
````

## **ðŸš¨ ISSUES THAT WERE CAUSING PROBLEMS:**

**1. Missing Table References:** The query tried to reference tables that don't exist yet
**2. Complex Multi-Table Joins:** Too many joins at once causing failures
**3.