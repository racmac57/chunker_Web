===================================================================
' DEPARTMENT-SPECIFIC CATEGORIES
' ===================================================================

' Get the specific categories for each department
Private Function GetDepartmentCategories(deptName As String) As Variant
    Select Case UCase(deptName)
        Case "CHIEF"
            GetDepartmentCategories = Array( _
                "EWS_Notifications", _
                "FID_Cards_Denied", _
                "FID_Cards_Issued", _
                "Firearms_Disposition_Request", _
                "Handicapped_Placard_Denied", _
                "Handicapped_Placard_Issued", _
                "Injured_on_Duty", _
                "Investigation_Review_Background", _
                "Investigation_Review_Criminal_Intake", _
                "Investigation_Review_Internal_Affairs", _
                "Investigation_Review_Overtime", _
                "Investigation_Review_Second_Hand_Jewelry", _
                "Investigation_Review_Threat_Assessment", _
                "Investigation_Review_Training", _
                "Permit_Conceal_Carry_Denied", _
                "Permit_Conceal_Carry_Issued", _
                "Permit_Flashing_Light", _
                "Police_Involved_Motor_Vehicle_Accident", _
                "Press_Releases_PIO_Requests", _
                "Review_AB_License", _
                "Review_Coin_License", _
                "Review_Command_Level_Pursuit", _
                "Review_Command_Level_SOF", _
                "Review_Command_Level_UOF", _
                "Review_Secondary_Employment", _
                "Review_Taxi_License", _
                "Review_Towing_License" _
            )
            
        Case "PATROL"
            GetDepartmentCategories = Array( _
                "Calls_for_Service", _
                "Traffic_Stops", _
                "Arrests", _
                "Summonses_Issued", _
                "Motor_Vehicle_Accidents", _
                "Domestic_Violence_Incidents", _
                "Assault_Cases", _
                "Theft_Cases", _
                "Drug_Related_Incidents", _
                "Quality_of_Life_Issues", _
                "Community_Policing_Activities", _
                "Foot_Patrols", _
                "Business_Checks", _
                "School_Zone_Enforcement" _
            )
            
        Case "TRAFFIC"
            GetDepartmentCategories = Array( _
                "Moving_Violations", _
                "Parking_Violations", _
                "Motor_Vehicle_Accidents", _
                "DUI_Arrests", _
                "Speed_Enforcement", _
                "Seatbelt_Violations", _
                "Cell_Phone_Violations", _
                "Commercial_Vehicle_Inspections", _
                "School_Zone_Violations", _
                "Construction_Zone_Enforcement", _
                "Traffic_Control_Assignments", _
                "Special_Event_Traffic" _
            )
            
        Case "DETECTIVES"
            GetDepartmentCategories = Array( _
                "Cases_Assigned", _
                "Cases_Closed", _
                "Interviews_Conducted", _
                "Search_Warrants_Executed", _
                "Evidence_Collected", _
                "Court_Appearances", _
                "Follow_Up_Investigations", _
                "Surveillance_Operations", _
                "Inter_Agency_Cooperation", _
                "Victim_Services_Referrals" _
            )
            
        Case "CSB"
            GetDepartmentCategories = Array( _
                "Court_Appearances", _
                "Subpoenas_Served", _
                "Warrant_Services", _
                "Evidence_Processing", _
                "Case_File_Preparation", _
                "Discovery_Requests", _
                "Plea_Negotiations", _
                "Trial_Preparation" _
            )
            
        Case "COMMUNITY_ENGAGEMENT"
            GetDepartmentCategories = Array( _
                "Community_Events", _
                "School_Programs", _
                "Business_Outreach", _
                "Neighborhood_Meetings", _
                "Crime_Prevention_Programs", _
                "Social_Media_Engagement", _
                "Public_Speaking_Events", _
                "Partnership_Development" _
            )
            
        Case "HACSOC"
            GetDepartmentCategories = Array( _
                "Emergency_Operations", _
                "Special_Events_Security", _
                "Tactical_Responses", _
                "Training_Exercises", _
                "Equipment_Maintenance", _
                "Inter_Agency_Coordination" _
            )
            
        Case "OPS"
            GetDepartmentCategories = Array( _
                "Equipment_Maintenance", _
                "Fleet_Management", _
                "Facility_Operations", _
                "Technology_Support", _
                "Supply_Management", _
                "Safety_Inspections" _
            )
            
        Case "POLICY_TRAINING"
            GetDepartmentCategories = Array( _
                "Training_Sessions_Conducted", _
                "Officers_Trained", _
                "Policy_Updates", _
                "Certification_Programs", _
                "Compliance_Reviews", _
                "Training_Materials_Developed" _
            )
            
        Case "REMU"
            GetDepartmentCategories = Array( _
                "Records_Requests", _
                "Data_Entry", _
                "File_Management", _
                "Report_Processing", _
                "Compliance_Monitoring", _
                "Database_Maintenance" _
            )
            
        Case "SSOCC"
            GetDepartmentCategories = Array( _
                "Emergency_Calls_Received", _
                "Units_Dispatched", _
                "Response_Coordination", _
                "Communications_Support", _
                "System_Monitoring", _
                "Backup_Communications" _
            )
            
        Case "STACP"
            GetDepartmentCategories = Array( _
                "Strategic_Planning", _
                "Policy_Development", _
                "Performance_Analysis", _
                "Resource_Allocation", _
                "Compliance_Oversight", _
                "Operational_Reviews" _
            )
            
        Case Else
            ' Default generic categories
            GetDepartmentCategories = Array("General_Activity", "Reports", "Administrative")
    End Select
End Function

' Get appropriate columns for each category type
Private Function GetCategoryColumns(category As String) As Variant
    ' Determine category type and return appropriate columns
    Select Case True
        ' License/Permit related
        Case InStr(LCase(category), "license") > 0 Or InStr(LCase(category), "permit") > 0 Or InStr(LCase(category), "fid") > 0
            GetCategoryColumns = Array("Application_Number", "Applicant_Name", "Status", "Date_Processed", "Expiration_Date", "Fee_Amount", "Comments")
            
        ' Review/Investigation related  
        Case InStr(LCase(category), "review") > 0 Or InStr(LCase(category), "investigation") > 0
            GetCategoryColumns = Array("Case_Number", "Subject", "Status", "Assigned_To", "Date_Initiated", "Date_Completed", "Outcome", "Recommendations")
            
        ' Incident/Response related
        Case InStr(LCase(category), "incident") > 0 Or InStr(LCase(category), "accident") > 0 Or InStr(LCase(category), "response") > 0
            GetCategoryColumns = Array("Incident_Number", "Location", "Type", "Severity", "Units_Responded", "Response_Time_Min", "Status", "Follow_Up_Required")
            
        ' Violation/Citation related
        Case InStr(LCase(category), "violation") > 0 Or InStr(LCase(category), "citation") > 0
            GetCategoryColumns = Array("Citation_Number", "Violator_Name", "Violation_Type", "Location", "Fine_Amount", "Court_Date", "Status")
            
        ' Training/Education related
        Case InStr(LCase(category), "training") > 0 Or InStr(LCase(category), "program") > 0
            GetCategoryColumns = Array("Program_Name", "Participants", "Duration_Hours", "Instructor", "Completion_Rate", "Certification_Issued")
            
        ' Administrative/General
        Case InStr(LCase(category), "ews") > 0 Or InStr(LCase(category), "notification") > 0
            GetCategoryColumns = Array("Notification_Type", "Recipient", "Method", "Date_Sent", "Response_Required", "Status")
            
        ' Count-based activities
        Case InStr(LCase(category), "calls") > 0 Or InStr(LCase(category), "events") > 0
            GetCategoryColumns = Array("Count", "Type", "Priority_Level", "Duration_Min", "Outcome", "Follow_Up")
            
        ' Default columns
        Case Else
            GetCategoryColumns = Array("Count", "Type", "Status", "Details", "Outcome")
    End Select
End Function

' ===================================================================
' MAIN NAVIGATION FUNCTION - DEPARTMENT SPECIFIC
' ===================================================================

Sub TEST_Main_Navigation()
    Dim ws As Worksheet, tbl As ListObject, newRow As ListRow
    Dim logMessage As String, tableCount As Long
    Dim targetSheetName As String
    Dim categories As Variant
    
    Application.ScreenUpdating = False
    On Error GoTo ErrorHandler
    
    ' Get current month sheet name
    targetSheetName = Right(Year(Date), 2) & "_" & Format(Month(Date), "00")
    
    ' Try to find the sheet
    On Error Resume Next
    Set ws = ThisWorkbook.Sheets(targetSheetName)
    On Error GoTo 0
    
    If ws Is Nothing Then
        ' Sheet doesn't exist - offer to create it
        If MsgBox("Sheet '" & targetSheetName & "' not found for " & DEPARTMENT_NAME & "." & vbCrLf & vbCrLf & _
                  "Create it with " & DEPARTMENT_NAME & " specific tables? ", vbYesNo + vbQuestion) = vbYes Then
            Set ws = CreateDepartmentSheet(targetSheetName)
        Else
            GoTo CleanExit
        End If
    End If
    
    ' Navigate to the sheet
    ws.Activate
    ws.Select
    
    ' Check if sheet has tables - if not, create them
    tableCount = 0
    For Each tbl In ws.ListObjects
        If InStr(LCase(tbl.Name), "_mom_") > 0 Then
            tableCount = tableCount + 1
        End If
    Next tbl
    
    If tableCount = 0 Then
        MsgBox "No tables found. Creating " & DEPARTMENT_NAME & " specific tables...", vbInformation
        Call CreateDepartmentTables(ws, targetSheetName)
        
        ' Recount tables
        tableCount = 0
        For Each tbl In ws.ListObjects
            If InStr(LCase(tbl.Name), "_mom_") > 0 Then
                tableCount = tableCount + 1
            End If
        Next tbl
    End If
    
    ' Add rows to existing tables
    tableCount = 0
    logMessage = ""
    
    For Each tbl In ws.ListObjects
        If InStr(LCase(tbl.Name), "_mom_") > 0 Then
            On Error Resume Next
            Set newRow = tbl.ListRows.Add
            
            If Err.Number = 0 Then
                ' Fill basic fields
                Call FillBasicFields(newRow, tbl)
                tableCount = tableCount + 1
                logMessage = logMessage & "âœ… Added row to: " & tbl.Name & vbCrLf
                
                ' Position cursor
                If tableCount = 1 Then
                    newRow.Range.Cells(1, 5).Select ' First data column after basic fields
                End If
            Else
                logMessage = logMessage & "âŒ Failed: " & tbl.Name & " - " & Err.Description & vbCrLf
                Err.Clear
            End If
            On Error GoTo 0
        End If
    Next tbl
    
    ' Show results
    MsgBox "âœ… " & DEPARTMENT_NAME & " Data Entry Ready!" & vbCrLf & vbCrLf & _
           "ðŸ“ Sheet: " & targetSheetName & vbCrLf & _
           "ðŸ“‹ Tables processed: " & tableCount & vbCrLf & _
           "ðŸŽ¯ Cursor positioned for data entry" & vbCrLf & vbCrLf & _
           "Details:" & vbCrLf & logMessage, vbInformation

CleanExit:
    Application.ScreenUpdating = True
    Exit Sub

ErrorHandler:
    Application.ScreenUpdating = True
    MsgBox "Error: " & Err.Description, vbCritical
    Exit Sub
End Sub

' Create new department sheet with specific tables
Private Function CreateDepartmentSheet(sheetName As String) As Worksheet
    Dim newSheet As Worksheet
    
    Set newSheet = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
    newSheet.Name = sheetName
    
    ' Add header
    With newSheet.Range("A1")
        .Value = DEPARTMENT_NAME & " - " & sheetName & " Tracking"
        .Font.Bold = True
        .Font.Size = 14
        .Interior.Color = RGB(79, 129, 189)
        .Font.Color = RGB(255, 255, 255)
    End With
    
    ' Create department-specific tables
    Call CreateDepartmentTables(newSheet, sheetName)
    
    Set CreateDepartmentSheet = newSheet
End Function

' Create tables specific to the department
Private Sub CreateDepartmentTables(ws As Worksheet, sheetName As String)
    Dim categories As Variant, i As Long
    Dim tableName As String, startRow As Long
    
    ' Get department-specific categories
    categories = GetDepartmentCategories(DEPARTMENT_NAME)
    
    startRow = 3 ' Start after header
    
    ' Create a table for each category
    For i = LBound(categories) To UBound(categories)
        tableName = "_mom_" & categories(i) & "_" & Replace(sheetName, "_", "_")
        
        Call CreateCategoryTable(ws, tableName, CStr(categories(i)), startRow)
        
        startRow = startRow + 15 ' Space between tables
    Next i
    
    MsgBox "âœ… Created " & (UBound(categories) - LBound(categories) + 1) & " tables for " & DEPARTMENT_NAME, vbInformation
End Sub

' Create individual category table
Private Sub CreateCategoryTable(ws As Worksheet, tableName As String, category As String, startRow As Long)
    Dim commonColumns As Variant, categoryColumns As Variant, allColumns As Variant
    Dim tbl As ListObject, i As Long
    
    ' Common columns for all tables
    commonColumns = Array("Date", "Time", "Officer", "Shift")
    
    ' Category-specific columns
    categoryColumns = GetCategoryColumns(category)
    
    ' Combine arrays
    allColumns = CombineArrays(commonColumns, categoryColumns)
    
    ' Create headers
    For i = LBound(allColumns) To UBound(allColumns)
        ws.Cells(startRow, i + 1).Value = allColumns(i)
    Next i
    
    ' Create table
    Dim tableRange As Range
    Set tableRange = ws.Range(ws.Cells(startRow, 1), ws.Cells(startRow + 1, UBound(allColumns) + 1))
    Set tbl = ws.ListObjects.Add(xlSrcRange, tableRange, , xlYes)
    tbl.Name = tableName
    
    ' Format table
    With tbl.HeaderRowRange
        .Font.Bold = True
        .Interior.Color = RGB(79, 129, 189)
        .Font.Color = RGB(255, 255, 255)
    End With
    
    tbl.TableStyle = "TableStyleMedium2"
    
    ' Add category label
    ws.Cells(startRow - 1, 1).Value = Replace(category, "_", " ")
    ws.Cells(startRow - 1, 1).Font.Bold = True
    ws.Cells(startRow - 1, 1).Font.Size = 12
End Sub

' Fill basic fields in new row
Private Sub FillBasicFields(newRow As ListRow, tbl As ListObject)
    On Error Resume Next
    
    If newRow Is Nothing Or tbl Is Nothing Then Exit Sub
    If tbl.HeaderRowRange Is Nothing Then Exit Sub
    
    ' Fill basic columns (Date, Time, Officer, Shift)
    newRow.Range.Cells(1, 1).Value = Date ' Date
    newRow.Range.Cells(1, 2).Value = Time ' Time
    newRow.Range.Cells(1, 3).Value = Environ("USERNAME") ' Officer
    
    ' Determine shift
    Dim currentHour As Integer
    currentHour = Hour(Now)
    If currentHour >= 6 And currentHour < 14 Then
        newRow.Range.Cells(1, 4).Value = "Day"
    ElseIf currentHour >= 14 And currentHour < 22 Then
        newRow.Range.Cells(1, 4).Value = "Evening"
    Else
        newRow.Range.Cells(1, 4).Value = "Night"
    End If
    
    On Error GoTo 0
End Sub

' Utility function to combine arrays
Private Function CombineArrays(arr1 As Variant, arr2 As Variant) As Variant
    Dim result() As Variant, i As Long, totalSize As Long
    
    totalSize = UBound(arr1) - LBound(arr1) + UBound(arr2) - LBound(arr2) + 2
    ReDim result(0 To totalSize - 1)
    
    ' Copy first array
    For i = LBound(arr1) To UBound(arr1)
        result(i - LBound(arr1)) = arr1(i)
    Next i
    
    ' Copy second array
    For i = LBound(arr2) To UBound(arr2)
        result(UBound(arr1) - LBound(arr1) + 1 + i - LBound(arr2)) = arr2(i)
    Next i
    
    CombineArrays = result
End Function

' ===================================================================
' DEPARTMENT SETUP FUNCTION
' ===================================================================

' Easy way to set up any department
Sub TEST_Setup_Department()
    Dim deptName As String, deptList As String
    
    deptList = "Available departments:" & vbCrLf & vbCrLf & _
               "â€¢ Chief" & vbCrLf & _
               "â€¢ Patrol" & vbCrLf & _
               "â€¢ Traffic" & vbCrLf & _
               "â€¢ Detectives" & vbCrLf & _
               "â€¢ CSB" & vbCrLf & _
               "â€¢ Community_Engagement" & vbCrLf & _
               "â€¢ HacSOC" & vbCrLf & _
               "â€¢ OPS" & vbCrLf & _
               "â€¢ Policy_Training" & vbCrLf & _
               "â€¢ REMU" & vbCrLf & _
               "â€¢ SSOCC" & vbCrLf & _
               "â€¢ STACP" & vbCrLf & vbCrLf & _
               "Enter department name:"
    
    deptName = InputBox(deptList, "Department Setup", DEPARTMENT_NAME)
    
    If deptName = "" Then Exit Sub
    
    ' Show what categories this department will track
    Dim categories As Variant, categoryList As String, i As Long
    categories = GetDepartmentCategories(UCase(deptName))
    
    categoryList = deptName & " will track these categories:" & vbCrLf & vbCrLf
    For i = LBound(categories) To UBound(categories)
        categoryList = categoryList & "â€¢ " & Replace(categories(i), "_", " ") & vbCrLf
    Next i
    
    categoryList = categoryList & vbCrLf & "Continue with setup?" If MsgBox(categoryList, vbYesNo + vbQuestion, "Confirm Department Setup") = vbYes Then
        MsgBox "To complete setup:" & vbCrLf & vbCrLf & _
               "1. Change DEPARTMENT_NAME constant to: " & deptName & vbCrLf & _
               "2. Save the file" & vbCrLf & _
               "3. Run TEST_Main_Navigation to create tables", vbInformation
    End If
End Sub

' Show department categories
Sub TEST_Show_Categories()
    Dim categories As Variant, categoryList As String, i As Long
    
    categories = GetDepartmentCategories(DEPARTMENT_NAME)
    
    categoryList = DEPARTMENT_NAME & " tracks these categories:" & vbCrLf & vbCrLf
    For i = LBound(categories) To UBound(categories)
        categoryList = categoryList & (i + 1) & ". " & Replace(categories(i), "_", " ") & vbCrLf
    Next i
    
    categoryList = categoryList & vbCrLf & "Total: " & (UBound(categories) - LBound(categories) + 1) & " categories"
    
    MsgBox categoryList, vbInformation, DEPARTMENT_NAME & " Categories"
End Sub
````

Now I understand! Each department needs **completely different tables** based on what they actually track. Here's the corrected system:

## ðŸŽ¯ **Department-Specific Categories**

### **Chief Department Tables:**
- EWS_Notifications
- FID_Cards_Denied  
- FID_Cards_Issued
- Firearms_Disposition_Request
- Handicapped_Placard_Denied
- Handicapped_Placard_Issued
- Investigation_Review_Background
- Investigation_Review_Criminal_Intake
- Investigation_Review_Internal_Affairs
- Investigation_Review_Overtime
- [And all the other Chief-specific categories...]

### **How This New System Works:**

1. **Department-Specific Setup**: Each file gets configured for its specific department
2. **Real Categories**: Tables match what each office actually tracks
3. **Smart Columns**: Each category type gets appropriate columns (permits get applicant info, reviews get case numbers, etc.) ## ðŸ”§ **To Set Up Chief Department:**

1. **Replace your VBA** with the code above
2. **Change the department constant**:
   ```vb
   Private Const DEPARTMENT_NAME As String = "Chief"
   ```
3. **Run `TEST_Main_Navigation`**
4. **System creates 27 tables** specific to Chief's tracking needs

## ðŸ“‹ **Sample Chief Tables Created:**

### **FID_Cards_Issued Table:**
| Date | Time | Officer | Shift | Application_Number | Applicant_Name | Status | Date_Processed | Expiration_Date | Fee_Amount | Comments |

### **Investigation_Review_Background Table:**
| Date | Time | Officer | Shift | Case_Number | Subject | Status | Assigned_To | Date_Initiated | Date_Completed | Outcome | Recommendations |

### **EWS_Notifications Table:**
| Date | Time | Officer | Shift | Notification_Type | Recipient | Method | Date_Sent | Response_Required | Status |

## ðŸš€ **Quick Setup Options:**

- **`TEST_Setup_Department`** - Choose any department and see its categories
- **`TEST_Show_Categories`** - View all categories for current department
- **`TEST_Main_Navigation`** - Create tables and start data entry

**This system now matches exactly what each department actually tracks instead of generic categories. Want me to set up the Chief department specifically, or would you like to see another department's setup? **



## Prompt:
5/31/2025, 10:46:13 PM

CSB office tracks 
Arrests Assist Outside Agency Burglary Arrests BWC Review(s) Catalytic Converter Arrests City Ordinance Citation City Ordinance Warning Criminal Intelligence Reports Criminal Mischief Arrests Criminal Trespass Arrests Currency Seized Drug-Related Arrests Fraud Arrests Generated Complaints Motor Vehicle Stops Motor Vehicle Theft Post-Investigation Arrests Robbery Arrests Search Warrants Executed Subpoenas Generated Surveillance Reports Theft Warrant Arrests Weapons Recovered



## Response:
5/31/2025, 10:46:41 PM

Perfect! Let me update the CSB categories with their actual tracking items. I'll modify the system to include CSB's real categories:

**Department-Specific Table System** âˆ™ Version 3

````vb
' ===================================================================
' DEPARTMENT-SPECIFIC TABLE SYSTEM
' Each department gets tables for their actual tracking categories
' ===================================================================

Option Explicit

' ===================================================================
' DEPARTMENT CONFIGURATION - CHANGE THIS FOR EACH DEPARTMENT
' ===================================================================
Private Const DEPARTMENT_NAME As String = "Chief" ' CHANGE: Chief, Patrol, Traffic, etc.

'