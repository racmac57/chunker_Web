# Enterprise Chunker System

A robust, enterprise-grade text chunking system with database tracking, notifications, and parallel processing capabilities. ## Features

- **Intelligent Text Chunking**: Splits large text files into manageable chunks while preserving semantic meaning
- **Database Tracking**: SQLite database for tracking processing history, errors, and analytics
- **Parallel Processing**: Multi-threaded processing for improved performance
- **Department-Specific Configurations**: Different chunking rules for different departments (police, admin, legal)
- **Redaction Support**: Automatic redaction of sensitive information (SSN, phone numbers, addresses, emails)
- **Cloud Synchronization**: Optional cloud backup of processed chunks
- **Comprehensive Logging**: Detailed logging with rotation and archiving
- **Email Notifications**: Configurable email alerts for errors and system events
- **System Monitoring**: Real-time CPU, memory, and disk usage tracking
- **File Stability Detection**: Waits for files to be completely written before processing

## Quick Start

### 1. Install Dependencies

```bash
pip install -r requirements.txt
```

### 2. Configure the System

Edit `config.json` to set your preferences:

```json
{
  "watch_folder": "C:/Users/your_username/Documents/chunker",
  "output_dir": "output",
  "archive_dir": "processed",
  "chunk_size": 100,
  "polling_interval": 5
}
```

### 3. Run the Watcher

```bash
python watcher_splitter.py
```

The system will:
- Monitor the watch folder for files ending in `_full_conversation.txt`
- Process them automatically when detected
- Create chunks in the output directory
- Move processed files to the archive directory
- Log all activities to the database

## Configuration Options

### Main Configuration (`config.json`)

- `watch_folder`: Directory to monitor for new files
- `output_dir`: Where to save chunked files
- `archive_dir`: Where to move processed files
- `chunk_size`: Number of sentences per chunk
- `polling_interval`: How often to check for new files (seconds)
- `cloud_repo_root`: Optional cloud backup location
- `enable_parallel_processing`: Enable multi-threading

### Department Configurations

Different departments have different chunking rules:

- **Police**: 75 sentences per chunk, redaction enabled, full audit
- **Admin**: 150 sentences per chunk, no redaction, basic audit
- **Legal**: 100 sentences per chunk, redaction enabled, full audit

## File Naming Convention

The system looks for files with the pattern: `*_full_conversation.txt`

Example: `meeting_notes_full_conversation.txt`

## Output Structure

Processed files create:
- Multiple chunk files: `timestamp_filename_chunk1.txt`, `timestamp_filename_chunk2.txt`, etc. - Metadata files (if cloud sync enabled)
- Database entries tracking the processing

## Testing

Run the test script to verify functionality:

```bash
python test_chunker.py
```

This will:
- Test the chunking algorithm
- Process a sample file
- Create test output files

## Database

The system uses SQLite (`chunker_tracking.db`) to track:
- Processing history
- Error logs
- System metrics
- Department statistics

## Notifications

Email notifications can be configured in `notification_config.json`:

```json
{
  "enable_notifications": true,
  "smtp_server": "smtp.gmail.com",
  "smtp_port": 587,
  "smtp_username": "your_email@gmail.com",
  "smtp_password": "your_app_password",
  "admin_emails": ["admin@yourcompany.com"]
}
```

## Logs

Logs are stored in `logs/watcher.log` with automatic rotation when they exceed 5MB. ## Troubleshooting

### Common Issues

1. **Import Errors**: Make sure all dependencies are installed
2. **Permission Errors**: Check folder permissions for watch, output, and archive directories
3. **Database Errors**: The system will create the database automatically
4. **Email Notifications**: Configure SMTP settings or disable notifications

### Debug Mode

Add logging to see more detailed information:

```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

## Architecture

- `watcher_splitter.py`: Main application
- `chunker_db.py`: Database operations
- `notification_system.py`: Email notifications
- `config.json`: Main configuration
- `requirements.txt`: Python dependencies

## Performance

- Supports parallel processing of multiple files
- Optimized for large text files
- Memory-efficient chunking algorithm
- Automatic cleanup of old data

## Security

- Redaction of sensitive information
- Secure file handling
- Audit trails for all operations
- Configurable access controls

## Support

For issues or questions, check the logs in `logs/watcher.log` or the database for detailed error information.