## Project Structure

```
ClaudeExportFixer/
â”œâ”€â”€ patch_conversations.py          # Main CLI script (v1.1.0)
â”œâ”€â”€ gui.py                          # Optional Tkinter GUI interface
â”œâ”€â”€ README.md                       # This file
â”œâ”€â”€ CHANGELOG.md                    # Version history and changes
â”œâ”€â”€ SUMMARY.md                      # Project overview
â”œâ”€â”€ requirements.txt                # Runtime dependencies (ijson, pytest)
â”œâ”€â”€ requirements-build.txt          # Build dependencies (pyinstaller)
â”œâ”€â”€ .gitignore                      # Git ignore rules
â”‚
â”œâ”€â”€ sample/                         # Example data files
â”‚   â”œâ”€â”€ conversations.example.json  # Sample conversation export
â”‚   â””â”€â”€ projects.example.json       # Sample projects file
â”‚
â”œâ”€â”€ tests/                          # Test suite
â”‚   â”œâ”€â”€ test_smoke.py              # Basic smoke tests
â”‚   â”œâ”€â”€ test_gui_import.py         # GUI import tests
â”‚   â”œâ”€â”€ test_gui_utils.py          # GUI helper function tests
â”‚   â”œâ”€â”€ test_gui_open_output.py    # GUI open output functionality tests
â”‚   â””â”€â”€ test_print_logging_bridge.py # Logging completeness tests
â”‚
â”œâ”€â”€ utils/                          # Analysis and troubleshooting utilities
â”‚   â”œâ”€â”€ PROMPT_FOR_GROK.md         # Troubleshooting documentation
â”‚   â”œâ”€â”€ GROK_TROUBLESHOOTING_REPORT.md # Issue analysis
â”‚   â”œâ”€â”€ current_merge_function.py  # Code reference
â”‚   â”œâ”€â”€ claude_export_sample_structure.json # Sample data
â”‚   â”œâ”€â”€ analyze_output.py          # Output validation tool
â”‚   â”œâ”€â”€ check_merging.py           # Merging verification
â”‚   â””â”€â”€ detailed_analysis.py       # Statistics analysis
â”‚
â”œâ”€â”€ scripts/windows/                # Windows automation scripts
â”‚   â”œâ”€â”€ create_venv.bat            # Setup virtual environment
â”‚   â”œâ”€â”€ run_tests.bat              # Run test suite
â”‚   â”œâ”€â”€ run_gui.bat                # Launch GUI
â”‚   â”œâ”€â”€ run_example_json.bat       # Process JSON example
â”‚   â”œâ”€â”€ run_example_zip_stream.bat # Process ZIP example
â”‚   â”œâ”€â”€ build_exe.bat              # Build CLI executable
â”‚   â””â”€â”€ build_exe_gui.bat          # Build GUI executable
â”‚
â””â”€â”€ .github/                        # GitHub integration
    â”œâ”€â”€ workflows/
    â”‚   â”œâ”€â”€ ci.yml                 # Continuous integration
    â”‚   â””â”€â”€ release.yml            # Release automation
    â”œâ”€â”€ ISSUE_TEMPLATE/
    â”‚   â”œâ”€â”€ bug_report.yml         # Bug report template
    â”‚   â””â”€â”€ feature_request.yml    # Feature request template
    â”œâ”€â”€ PULL_REQUEST_TEMPLATE.md   # PR template
    â””â”€â”€ CONTRIBUTING.md            # Contributing guidelines
```

## Key Files

- **`patch_conversations.py`** - Main script with CLI and `--gui` flag
- **`gui.py`** - Standalone Tkinter GUI (optional, stdlib only)
- **`CHANGELOG.md`** - Track all project changes here
- **`LICENSE`** - MIT License
- **`SECURITY.md`** - Security policy and vulnerability reporting
- **`requirements.txt`** - Runtime dependencies (ijson, pytest)
- **`requirements-build.txt`** - Build dependencies (pyinstaller)
- **`utils/`** - Analysis and troubleshooting tools
- **`.github/`** - GitHub integration (workflows, issue templates, contributing guide)

## Contributing

See [CONTRIBUTING.md](.github/CONTRIBUTING.md) for contribution guidelines. ## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details. ```

```markdown
# ClaudeExportFixer

**Complete toolkit for Claude conversation exports:** Fix, validate, search, and build knowledge bases from your Claude.ai chat history. **Latest:** v1.2.0
- âœ… Full osteele viewer compatibility (`content`, `model`, `index`, `model_slug` fields)
- ğŸ” NEW: Searchable knowledge base builder with semantic chunking
- ğŸ“Š Tag extraction, full-text search, and analytics-ready SQLite database

## Quick start (Windows)
```bat
cd C:\Dev\ClaudeExportFixer
scripts\windows\create_venv.bat
```

## GUI Mode

Launch a graphical interface (requires Tkinter, included in Python stdlib):

```bat
py patch_conversations.py --gui
```

Or directly:

```bat
py gui.py
```

Or use the convenient batch script:

```bat
scripts\windows\run_gui.bat
```

- Select input (`conversations.json` or `.zip`) and output paths. - Check options (e.g., `--pretty` is on by default). - Click "Run" to process; logs appear in real-time. - On success, output and report paths are shown; click "Open Output" to view the output file in your default application. - If Tkinter cannot initialize (e.g., headless environment), use CLI or run on a system with a display. ## Features

### ğŸ”§ Export Fixer (`patch_conversations.py`)
- **Full osteele viewer compatibility** - Adds all required schema fields
- **Rich attachment handling** - Merges `files` and `attachments`, preserves metadata
- **Format normalization** - Handles both list and dict conversation formats
- **ZIP support** - Process exports without extraction
- **Streaming mode** - Handle large exports efficiently with `ijson`

### ğŸ” Knowledge Base Builder (`claude_knowledge_base.py`) **NEW! **
- **Searchable database** - Convert exports to SQLite with full-text search (FTS5)
- **Semantic chunking** - NLTK sentence-aware chunking (150 words max)
- **Auto-tagging** - Extract tech keywords, date tags, content types
- **File indexing** - Search attachment extracted content
- **Analytics-ready** - Conversation stats, message counts, token estimates

### ğŸ–¥ï¸ GUI Mode (`gui.py`)
- **Drag-and-drop** interface with Tkinter
- **Real-time logs** - Watch processing progress
- **One-click open** - Launch output in default app

## CLI Usage

### Fix Export for osteele Viewer

Process a JSON:

```bat
python patch_conversations.py conversations.json -o fixed.json --pretty
```

Process a ZIP (streaming):

```bat
python patch_conversations.py export.zip -o export_patched.zip --zip-output --stream --pretty
```

### Build Knowledge Base

Create searchable database from export:

```bat
python claude_knowledge_base.py conversations.json claude_kb.db
```

Or from ZIP:

```bat
python claude_knowledge_base.py export.zip my_knowledge_base.db
```

**Features:**
- Full-text search across all conversations
- Tag-based organization (auto-extracted)
- Message and file content indexing
- Analytics queries (conversation counts, date ranges, etc.) Run tests:

```bat
scripts\windows\run_tests.bat
```

## Building Executables

### CLI only

```bat
pip install pyinstaller
pyinstaller --onefile patch_conversations.py
```

Or use the provided script:

```bat
scripts\windows\build_exe.bat
```

### GUI (windowed)

```bat
pip install pyinstaller
pyinstaller --onefile --windowed patch_conversations.py
```

Or use the provided script:

```bat
scripts\windows\build_exe_gui.bat
```

Output: `dist/patch_conversations.exe`. Run GUI with `--gui` flag. **Note:** No additional dependencies required; Tkinter is part of Python stdlib. For GUI-only launch without console on Windows, build with `--windowed` and run `patch_conversations.exe --gui`. ## Updates

### v1.1.1 (2025-10-27) - Critical Fix Release
* **Fixed**: Attachment merging for Claude's rich attachment format (`file_name`, `file_size`, `file_type`, `extracted_content`)
* **Fixed**: Support for Claude's list format conversations (top-level array)
* **Added**: 10 comprehensive tests for rich attachment merging
* **Result**: 100% merge success rate on real Claude exports with all metadata preserved
* **Tests**: 23/23 passing

## Notes

* `ijson` is optional but required for `--stream` support. * Tkinter (for GUI) is included in Python stdlib on Windows and macOS. * See `CHANGELOG.md` for version history and changes. * See `SUMMARY.md` for project overview. * See `.github/CONTRIBUTING.md` for contribution guidelines. ## Project Structure

```
ClaudeExportFixer/
â”œâ”€â”€ patch_conversations.py          # Main CLI script (v1.1.0)
â”œâ”€â”€ gui.py                          # Optional Tkinter GUI interface
â”œâ”€â”€ README.md                       # This file
â”œâ”€â”€ CHANGELOG.md                    # Version history and changes
â”œâ”€â”€ SUMMARY.md                      # Project overview
â”œâ”€â”€ requirements.txt                # Runtime dependencies (ijson, pytest)
â”œâ”€â”€ requirements-build.txt          # Build dependencies (pyinstaller)
â”œâ”€â”€ .gitignore                      # Git ignore rules
â”‚
â”œâ”€â”€ sample/                         # Example data files
â”‚   â”œâ”€â”€ conversations.example.json  # Sample conversation export
â”‚   â””â”€â”€ projects.example.json       # Sample projects file
â”‚
â”œâ”€â”€ tests/                          # Test suite
â”‚   â”œâ”€â”€ test_smoke.py              # Basic smoke tests
â”‚   â”œâ”€â”€ test_gui_import.py         # GUI import tests
â”‚   â”œâ”€â”€ test_gui_utils.py          # GUI helper function tests
â”‚   â”œâ”€â”€ test_gui_open_output.py    # GUI open output functionality tests
â”‚   â””â”€â”€ test_print_logging_bridge.py # Logging completeness tests
â”‚
â”œâ”€â”€ utils/                          # Analysis and troubleshooting utilities
â”‚   â”œâ”€â”€ PROMPT_FOR_GROK.md         # Troubleshooting documentation
â”‚   â”œâ”€â”€ GROK_TROUBLESHOOTING_REPORT.md # Issue analysis
â”‚   â”œâ”€â”€ current_merge_function.py  # Code reference
â”‚   â”œâ”€â”€ claude_export_sample_structure.json # Sample data
â”‚   â”œâ”€â”€ analyze_output.py          # Output validation tool
â”‚   â”œâ”€â”€ check_merging.py           # Merging verification
â”‚   â””â”€â”€ detailed_analysis.py       # Statistics analysis
â”‚
â”œâ”€â”€ scripts/windows/                # Windows automation scripts
â”‚   â”œâ”€â”€ create_venv.bat            # Setup virtual environment
â”‚   â”œâ”€â”€ run_tests.bat              # Run test suite
â”‚   â”œâ”€â”€ run_gui.bat                # Launch GUI
â”‚   â”œâ”€â”€ run_example_json.bat       # Process JSON example
â”‚   â”œâ”€â”€ run_example_zip_stream.bat # Process ZIP example
â”‚   â”œâ”€â”€ build_exe.bat              # Build CLI executable
â”‚   â””â”€â”€ build_exe_gui.bat          # Build GUI executable
â”‚
â””â”€â”€ .github/                        # GitHub integration
    â”œâ”€â”€ workflows/
    â”‚   â”œâ”€â”€ ci.yml                 # Continuous integration
    â”‚   â””â”€â”€ release.yml            # Release automation
    â”œâ”€â”€ ISSUE_TEMPLATE/
    â”‚   â”œâ”€â”€ bug_report.yml         # Bug report template
    â”‚   â””â”€â”€ feature_request.yml    # Feature request template
    â”œâ”€â”€ PULL_REQUEST_TEMPLATE.md   # PR template
    â””â”€â”€ CONTRIBUTING.md            # Contributing guidelines
```

## Key Files

- **`patch_conversations.py`** - Main script with CLI and `--gui` flag
- **`gui.py`** - Standalone Tkinter GUI (optional, stdlib only)
- **`CHANGELOG.md`** - Track all project changes here
- **`LICENSE`** - MIT License
- **`SECURITY.md`** - Security policy and vulnerability reporting
- **`requirements.txt`** - Runtime dependencies (ijson, pytest)
- **`requirements-build.txt`** - Build dependencies (pyinstaller)
- **`utils/`** - Analysis and troubleshooting tools
- **`.github/`** - GitHub integration (workflows, issue templates, contributing guide)

## Contributing

See [CONTRIBUTING.md](.github/CONTRIBUTING.md) for contribution guidelines. ## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details. ```

Now let me find and update the project structure section:

```markdown
# ClaudeExportFixer

**Complete toolkit for Claude conversation exports:** Fix, validate, search, and build knowledge bases from your Claude.ai chat history. **Latest:** v1.2.0
- âœ… Full osteele viewer compatibility (`content`, `model`, `index`, `model_slug` fields)
- ğŸ” NEW: Searchable knowledge base builder with semantic chunking
- ğŸ“Š Tag extraction, full-text search, and analytics-ready SQLite database

## Quick start (Windows)
```bat
cd C:\Dev\ClaudeExportFixer
scripts\windows\create_venv.bat
```

## GUI Mode

Launch a graphical interface (requires Tkinter, included in Python stdlib):

```bat
py patch_conversations.py --gui
```

Or directly:

```bat
py gui.py
```

Or use the convenient batch script:

```bat
scripts\windows\run_gui.bat
```

- Select input (`conversations.json` or `.zip`) and output paths. - Check options (e.g., `--pretty` is on by default). - Click "Run" to process; logs appear in real-time. - On success, output and report paths are shown; click "Open Output" to view the output file in your default application. - If Tkinter cannot initialize (e.g., headless environment), use CLI or run on a system with a display. ## Features

### ğŸ”§ Export Fixer (`patch_conversations.py`)
- **Full osteele viewer compatibility** - Adds all required schema fields
- **Rich attachment handling** - Merges `files` and `attachments`, preserves metadata
- **Format normalization** - Handles both list and dict conversation formats
- **ZIP support** - Process exports without extraction
- **Streaming mode** - Handle large exports efficiently with `ijson`

### ğŸ” Knowledge Base Builder (`claude_knowledge_base.py`) **NEW! **
- **Searchable database** - Convert exports to SQLite with full-text search (FTS5)
- **Semantic chunking** - NLTK sentence-aware chunking (150 words max)
- **Auto-tagging** - Extract tech keywords, date tags, content types
- **File indexing** - Search attachment extracted content
- **Analytics-ready** - Conversation stats, message counts, token estimates

### ğŸ–¥ï¸ GUI Mode (`gui.py`)
- **Drag-and-drop** interface with Tkinter
- **Real-time logs** - Watch processing progress
- **One-click open** - Launch output in default app

## CLI Usage

### Fix Export for osteele Viewer

Process a JSON:

```bat
python patch_conversations.py conversations.json -o fixed.json --pretty
```

Process a ZIP (streaming):

```bat
python patch_conversations.py export.zip -o export_patched.zip --zip-output --stream --pretty
```

### Build Knowledge Base

Create searchable database from export:

```bat
python claude_knowledge_base.py conversations.json claude_kb.db
```

Or from ZIP:

```bat
python claude_knowledge_base.py export.zip my_knowledge_base.db
```

**Features:**
- Full-text search across all conversations
- Tag-based organization (auto-extracted)
- Message and file content indexing
- Analytics queries (conversation counts, date ranges, etc.) Run tests:

```bat
scripts\windows\run_tests.bat
```

## Building Executables

### CLI only

```bat
pip install pyinstaller
pyinstaller --onefile patch_conversations.py
```

Or use the provided script:

```bat
scripts\windows\build_exe.bat
```

### GUI (windowed)

```bat
pip install pyinstaller
pyinstaller --onefile --windowed patch_conversations.py
```

Or use the provided script:

```bat
scripts\windows\build_exe_gui.bat
```

Output: `dist/patch_conversations.exe`. Run GUI with `--gui` flag. **Note:** No additional dependencies required; Tkinter is part of Python stdlib. For GUI-only launch without console on Windows, build with `--windowed` and run `patch_conversations.exe --gui`. ## Updates

### v1.2.0 (2025-10-27) - Knowledge Base & Full Schema Compliance
* **NEW**: `claude_knowledge_base.py` - Convert exports to searchable SQLite database
  - Semantic chunking with NLTK (150 words, sentence-aware)
  - Auto-tag extraction (tech keywords, dates, content types)
  - FTS5 full-text search across all conversations
  - File/attachment content indexing
* **CRITICAL**: Added all missing osteele viewer schema fields
  - `content` array for all messages (required by viewer schema)
  - `model` field for conversations
  - `index` and `model_slug` for all messages
  - Analyzed viewer source code from github.com/osteele/claude-chat-viewer
* **Result**: 100% schema compliance (all 401 conversations, 10,369 messages)
* **Tests**: 24/24 passing

### v1.1.1 (2025-10-27) - Critical Fix Release
* **Fixed**: Attachment merging for Claude's rich attachment format
* **Fixed**: Support for Claude's list format conversations
* **Added**: 10 comprehensive tests for rich attachment merging
* **Tests**: 23/23 passing

## Notes

* `ijson` is optional but required for `--stream` support. * Tkinter (for GUI) is included in Python stdlib on Windows and macOS. * See `CHANGELOG.md` for version history and changes. * See `SUMMARY.md` for project overview. * See `.github/CONTRIBUTING.md` for contribution guidelines. ## Project Structure

```
ClaudeExportFixer/
â”œâ”€â”€ patch_conversations.py          # Main CLI script (v1.1.0)
â”œâ”€â”€ gui.py                          # Optional Tkinter GUI interface
â”œâ”€â”€ README.md                       # This file
â”œâ”€â”€ CHANGELOG.md                    # Version history and changes
â”œâ”€â”€ SUMMARY.md                      # Project overview
â”œâ”€â”€ requirements.txt                # Runtime dependencies (ijson, pytest)
â”œâ”€â”€ requirements-build.txt          # Build dependencies (pyinstaller)
â”œâ”€â”€ .gitignore                      # Git ignore rules
â”‚
â”œâ”€â”€ sample/                         # Example data files
â”‚   â”œâ”€â”€ conversations.example.json  # Sample conversation export
â”‚   â””â”€â”€ projects.example.json       # Sample projects file
â”‚
â”œâ”€â”€ tests/                          # Test suite
â”‚   â”œâ”€â”€ test_smoke.py              # Basic smoke tests
â”‚   â”œâ”€â”€ test_gui_import.py         # GUI import tests
â”‚   â”œâ”€â”€ test_gui_utils.py          # GUI helper function tests
â”‚   â”œâ”€â”€ test_gui_open_output.py    # GUI open output functionality tests
â”‚   â””â”€â”€ test_print_logging_bridge.py # Logging completeness tests
â”‚
â”œâ”€â”€ utils/                          # Analysis and troubleshooting utilities
â”‚   â”œâ”€â”€ PROMPT_FOR_GROK.md         # Troubleshooting documentation
â”‚   â”œâ”€â”€ GROK_TROUBLESHOOTING_REPORT.md # Issue analysis
â”‚   â”œâ”€â”€ current_merge_function.py  # Code reference
â”‚   â”œâ”€â”€ claude_export_sample_structure.json # Sample data
â”‚   â”œâ”€â”€ analyze_output.py          # Output validation tool
â”‚   â”œâ”€â”€ check_merging.py           # Merging verification
â”‚   â””â”€â”€ detailed_analysis.py       # Statistics analysis
â”‚
â”œâ”€â”€ scripts/windows/                # Windows automation scripts
â”‚   â”œâ”€â”€ create_venv.bat            # Setup virtual environment
â”‚   â”œâ”€â”€ run_tests.bat              # Run test suite
â”‚   â”œâ”€â”€ run_gui.bat                # Launch GUI
â”‚   â”œâ”€â”€ run_example_json.bat       # Process JSON example
â”‚   â”œâ”€â”€ run_example_zip_stream.bat # Process ZIP example
â”‚   â”œâ”€â”€ build_exe.bat              # Build CLI executable
â”‚   â””â”€â”€ build_exe_gui.bat          # Build GUI executable
â”‚
â””â”€â”€ .github/                        # GitHub integration
    â”œâ”€â”€ workflows/
    â”‚   â”œâ”€â”€ ci.yml                 # Continuous integration
    â”‚   â””â”€â”€ release.yml            # Release automation
    â”œâ”€â”€ ISSUE_TEMPLATE/
    â”‚   â”œâ”€â”€ bug_report.yml         # Bug report template
    â”‚   â””â”€â”€ feature_request.yml    # Feature request template
    â”œâ”€â”€ PULL_REQUEST_TEMPLATE.md   # PR template
    â””â”€â”€ CONTRIBUTING.md            # Contributing guidelines
```

## Key Files

- **`patch_conversations.py`** - Main script with CLI and `--gui` flag
- **`gui.py`** - Standalone Tkinter GUI (optional, stdlib only)
- **`CHANGELOG.md`** - Track all project changes here
- **`LICENSE`** - MIT License
- **`SECURITY.md`** - Security policy and vulnerability reporting
- **`requirements.txt`** - Runtime dependencies (ijson, pytest)
- **`requirements-build.txt`** - Build dependencies (pyinstaller)
- **`utils/`** - Analysis and troubleshooting tools
- **`.github/`** - GitHub integration (workflows, issue templates, contributing guide)

## Contributing

See [CONTRIBUTING.md](.github/CONTRIBUTING.md) for contribution guidelines. ## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details. ```

```markdown
## Project Structure

```
ClaudeExportFixer/
â”œâ”€â”€ Core Scripts                    âœ… v1.2.0
â”‚   â”œâ”€â”€ patch_conversations.py      # Main export fixer (osteele viewer compatibility)
â”‚   â”œâ”€â”€ gui.py                      # Optional Tkinter GUI interface
â”‚   â”œâ”€â”€ claude_knowledge_base.py    # ğŸ†• KB builder with semantic search
â”‚   â””â”€â”€ GROK_KNOWLEDGE_BASE_PROMPT.md # ğŸ†• AI collaboration prompt
â”‚
â”œâ”€â”€ Documentation                   ğŸ“š Complete
â”‚   â”œâ”€â”€ README.md                   # This file (updated v1.2.0)
â”‚   â”œâ”€â”€ CHANGELOG.md                # Version history (updated v1.2.0)
â”‚   â”œâ”€â”€ SUMMARY.md                  # Project overview
â”‚   â”œâ”€â”€ LICENSE                     # MIT License
â”‚   â”œâ”€â”€ SECURITY.md                 # Security reporting
â”‚   â”œâ”€â”€ .gitattributes              # Line ending config
â”‚   â””â”€â”€ .gitignore                  # Git ignore rules
â”‚
â”œâ”€â”€ Configuration                   âš™ï¸ Dependencies
â”‚   â”œâ”€â”€ requirements.txt            # Runtime (ijson, pytest, nltk)
â”‚   â””â”€â”€ requirements-build.txt      # Build (pyinstaller)
â”‚
â”œâ”€â”€ sample/                         ğŸ“‹ Example data
â”‚   â”œâ”€â”€ conversations.example.json  # Sample conversation export
â”‚   â””â”€â”€ projects.example.json       # Sample projects file
â”‚
â”œâ”€â”€ tests/                          âœ… 24 tests passing
â”‚   â”œâ”€â”€ test_smoke.py              # Basic smoke tests
â”‚   â”œâ”€â”€ test_merge_rich_attachments.py # ğŸ†• Rich attachment tests (11 tests)
â”‚   â”œâ”€â”€ test_gui_import.py         # GUI import tests
â”‚   â”œâ”€â”€ test_gui_utils.py          # GUI helper function tests
â”‚   â”œâ”€â”€ test_gui_open_output.py    # GUI open output tests
â”‚   â””â”€â”€ test_print_logging_bridge.py # Logging completeness tests
â”‚
â”œâ”€â”€ utils/                          ğŸ” Analysis & verification tools (20+ scripts)
â”‚   â”œâ”€â”€ comprehensive_verification.py # Complete export validation
â”‚   â”œâ”€â”€ verify_created_at.py       # Timestamp verification
â”‚   â”œâ”€â”€ verify_v120_fix.py         # v1.2.0 field verification
â”‚   â”œâ”€â”€ check_common_schema_issues.py # Schema validation
â”‚   â”œâ”€â”€ analyze_failing_conversations.py # Failure pattern analysis
â”‚   â”œâ”€â”€ strict_validator.py        # Strict osteele schema validation
â”‚   â”œâ”€â”€ diagnose_conversation_4.py # Specific conversation debugging
â”‚   â”œâ”€â”€ find_pattern_in_failing.py # Pattern detection
â”‚   â”œâ”€â”€ create_filtered_export.py # Filter empty conversations
â”‚   â”œâ”€â”€ filter_empty_conversations.py # Remove invalid conversations
â”‚   â”œâ”€â”€ check_conversation_4.py    # Conversation debugging
â”‚   â”œâ”€â”€ PROMPT_FOR_GROK.md         # Original troubleshooting docs
â”‚   â”œâ”€â”€ GROK_TROUBLESHOOTING_REPORT.md # Issue analysis
â”‚   â”œâ”€â”€ analyze_output.py          # Output validation
â”‚   â”œâ”€â”€ check_merging.py           # Merge verification
â”‚   â”œâ”€â”€ detailed_analysis.py       # In-depth analysis
â”‚   â”œâ”€â”€ verify_fix.py              # Fix verification
â”‚   â”œâ”€â”€ verify_rich_data.py        # Rich metadata preservation
â”‚   â”œâ”€â”€ current_merge_function.py  # Code reference
â”‚   â””â”€â”€ claude_export_sample_structure.json # Sample data
```

```markdown
# ClaudeExportFixer

**Complete toolkit for Claude conversation exports:** Fix, validate, search, and build knowledge bases from your Claude.ai chat history. **Latest:** v1.2.0
- âœ… Full osteele viewer compatibility (`content`, `model`, `index`, `model_slug` fields)
- ğŸ” NEW: Searchable knowledge base builder with semantic chunking
- ğŸ“Š Tag extraction, full-text search, and analytics-ready SQLite database

## Quick start (Windows)
```bat
cd C:\Dev\ClaudeExportFixer
scripts\windows\create_venv.bat
```

## GUI Mode

Launch a graphical interface (requires Tkinter, included in Python stdlib):

```bat
py patch_conversations.py --gui
```

Or directly:

```bat
py gui.py
```

Or use the convenient batch script:

```bat
scripts\windows\run_gui.bat
```

- Select input (`conversations.json` or `.zip`) and output paths. - Check options (e.g., `--pretty` is on by default). - Click "Run" to process; logs appear in real-time. - On success, output and report paths are shown; click "Open Output" to view the output file in your default application. - If Tkinter cannot initialize (e.g., headless environment), use CLI or run on a system with a display. ## Features

### ğŸ”§ Export Fixer (`patch_conversations.py`)
- **Full osteele viewer compatibility** - Adds all required schema fields
- **Rich attachment handling** - Merges `files` and `attachments`, preserves metadata
- **Format normalization** - Handles both list and dict conversation formats
- **ZIP support** - Process exports without extraction
- **Streaming mode** - Handle large exports efficiently with `ijson`

### ğŸ” Knowledge Base Builder (`claude_knowledge_base.py`) **NEW! **
- **Searchable database** - Convert exports to SQLite with full-text search (FTS5)
- **Semantic chunking** - NLTK sentence-aware chunking (150 words max)
- **Auto-tagging** - Extract tech keywords, date tags, content types
- **File indexing** - Search attachment extracted content
- **Analytics-ready** - Conversation stats, message counts, token estimates

### ğŸ–¥ï¸ GUI Mode (`gui.py`)
- **Drag-and-drop** interface with Tkinter
- **Real-time logs** - Watch processing progress
- **One-click open** - Launch output in default app

## CLI Usage

### Fix Export for osteele Viewer

Process a JSON:

```bat
python patch_conversations.py conversations.json -o fixed.json --pretty
```

Process a ZIP (streaming):

```bat
python patch_conversations.py export.zip -o export_patched.zip --zip-output --stream --pretty
```

### Build Knowledge Base

Create searchable database from export:

```bat
python claude_knowledge_base.py conversations.json claude_kb.db
```

Or from ZIP:

```bat
python claude_knowledge_base.py export.zip my_knowledge_base.db
```

**Features:**
- Full-text search across all conversations
- Tag-based organization (auto-extracted)
- Message and file content indexing
- Analytics queries (conversation counts, date ranges, etc.) Run tests:

```bat
scripts\windows\run_tests.bat
```

## Building Executables

### CLI only

```bat
pip install pyinstaller
pyinstaller --onefile patch_conversations.py
```

Or use the provided script:

```bat
scripts\windows\build_exe.bat
```

### GUI (windowed)

```bat
pip install pyinstaller
pyinstaller --onefile --windowed patch_conversations.py
```

Or use the provided script:

```bat
scripts\windows\build_exe_gui.bat
```

Output: `dist/patch_conversations.exe`. Run GUI with `--gui` flag. **Note:** No additional dependencies required; Tkinter is part of Python stdlib. For GUI-only launch without console on Windows, build with `--windowed` and run `patch_conversations.exe --gui`. ## Updates

### v1.2.0 (2025-10-27) - Knowledge Base & Full Schema Compliance
* **NEW**: `claude_knowledge_base.py` - Convert exports to searchable SQLite database
  - Semantic chunking with NLTK (150 words, sentence-aware)
  - Auto-tag extraction (tech keywords, dates, content types)
  - FTS5 full-text search across all conversations
  - File/attachment content indexing
* **CRITICAL**: Added all missing osteele viewer schema fields
  - `content` array for all messages (required by viewer schema)
  - `model` field for conversations
  - `index` and `model_slug` for all messages
  - Analyzed viewer source code from github.com/osteele/claude-chat-viewer
* **Result**: 100% schema compliance (all 401 conversations, 10,369 messages)
* **Tests**: 24/24 passing

### v1.1.1 (2025-10-27) - Critical Fix Release
* **Fixed**: Attachment merging for Claude's rich attachment format
* **Fixed**: Support for Claude's list format conversations
* **Added**: 10 comprehensive tests for rich attachment merging
* **Tests**: 23/23 passing

## Notes

* `ijson` is optional but required for `--stream` support. * Tkinter (for GUI) is included in Python stdlib on Windows and macOS. * See `CHANGELOG.md` for version history and changes. * See `SUMMARY.md` for project overview. * See `.github/CONTRIBUTING.md` for contribution guidelines.