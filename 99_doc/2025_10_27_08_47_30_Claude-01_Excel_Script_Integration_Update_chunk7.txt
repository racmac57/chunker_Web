return os.path.join(REPORT_BASE_DIR, get_correct_folder_name(date_str))

def get_sql_pattern_for_crime(crime_type):
    """Get SQL pattern for specific crime type"""
    return CRIME_SQL_PATTERNS.get(crime_type, crime_type)

# =============================================================================
# VALIDATION FUNCTIONS
# =============================================================================

def validate_all_paths():
    """Validate that all paths in config.py exist and are accessible"""
    print("ğŸ” VALIDATING CONFIG PATHS")
    print("=" * 40)
    
    paths_to_check = {
        "Excel Cycle File": EXCEL_CYCLE_PATH,
        "Report Base Directory": REPORT_BASE_DIR,
        "ArcGIS Pro Project": APR_PATH,
        "Main PowerPoint Template": POWERPOINT_TEMPLATES.get("main", ""),
        "7-Day PowerPoint Template": POWERPOINT_TEMPLATES.get("7day", "")
    }
    
    all_valid = True
    
    for name, path in paths_to_check.items():
        if path and os.path.exists(path):
            print(f"âœ… {name}")
            print(f"   ğŸ“ {path}")
        else:
            print(f"âŒ {name} NOT FOUND")
            print(f"   ğŸ“ {path}")
            all_valid = False
        print()
    
    if all_valid:
        print("ğŸ‰ ALL PATHS VALIDATED - READY TO RUN!") else:
        print("âš ï¸ SOME PATHS MISSING - CHECK CONFIGURATION")
    
    return all_valid

def quick_config_test():
    """Quick test of all config functions"""
    print("âš¡ QUICK CONFIG TEST")
    print("=" * 30)
    
    # Test paths first
    if not validate_all_paths():
        print("âŒ Path validation failed - stopping test")
        return False
    
    # Test Excel integration
    test_date = date(2025, 6, 10)
    print(f"ğŸ“… Testing with: {test_date}")
    
    try:
        # Test report name lookup
        report_name = get_excel_report_name(test_date)
        print(f"ğŸ“‹ Report name: {report_name}")
        
        # Test folder generation
        folder_name = get_correct_folder_name(test_date)
        print(f"ğŸ“ Folder name: {folder_name}")
        
        # Test period calculation
        start_date, end_date = get_7day_period_dates(test_date)
        print(f"ğŸ“Š 7-Day period: {start_date} to {end_date}")
        
        # Test crime folder
        crime_folder = get_crime_type_folder("MV Theft", "2025_06_10")
        print(f"ğŸš” MV Theft folder: {crime_folder}")
        
        # Expected results check
        expected_checks = [
            (report_name == "C06W23", "Report name should be C06W23"),
            ("C06W23_2025_06_10_7Day" in folder_name, "Folder should contain C06W23_2025_06_10_7Day"),
            (start_date == date(2025, 6, 3), "Start date should be June 3, 2025"),
            (end_date == date(2025, 6, 9), "End date should be June 9, 2025"),
            ("MV_Theft" in crime_folder, "Crime folder should contain MV_Theft")
        ]
        
        print("\nğŸ” VALIDATION CHECKS:")
        all_passed = True
        for check_passed, description in expected_checks:
            if check_passed:
                print(f"âœ… {description}")
            else:
                print(f"âŒ {description}")
                all_passed = False
        
        if all_passed:
            print("\nğŸ‰ ALL TESTS PASSED! CONFIG IS READY!") return True
        else:
            print("\nâš ï¸ SOME TESTS FAILED - CHECK EXCEL DATA")
            return False
            
    except Exception as e:
        print(f"âŒ Test failed with error: {e}")
        return False

# =============================================================================
# TEST FUNCTIONS FOR DEBUGGING
# =============================================================================

def test_excel_integration():
    """Test script to verify Excel integration is working"""
    print("ğŸ§ª TESTING EXCEL INTEGRATION")
    print("=" * 50)
    
    # Test date: June 10, 2025
    test_date = date(2025, 6, 10)
    test_date_str = test_date.strftime("%Y_%m_%d")
    
    print(f"ğŸ“… Test date: {test_date}")
    print(f"ğŸ“… Test date string: {test_date_str}")
    
    # Test Excel lookup
    report_name = get_excel_report_name(test_date)
    print(f"ğŸ“‹ Excel report name: {report_name}")
    
    # Test folder name generation
    folder_name = get_correct_folder_name(test_date)
    print(f"ğŸ“ Folder name: {folder_name}")
    
    # Test 7-day period calculation
    start_date, end_date = get_7day_period_dates(test_date)
    print(f"ğŸ“Š 7-Day period: {start_date} to {end_date}")
    
    # Test Excel period lookup
    excel_start, excel_end = get_excel_7day_period(test_date)
    print(f"ğŸ“Š Excel 7-Day period: {excel_start} to {excel_end}")
    
    # Test crime type folder
    test_crime = "MV Theft"
    crime_folder = get_crime_type_folder(test_crime, test_date_str)
    print(f"ğŸš” Crime folder for {test_crime}: {crime_folder}")
    
    print("=" * 50)
    print("âœ… Excel integration test complete!") def test_sql_filter_generation():
    """Test SQL filter generation with Excel dates"""
    print("\nğŸ§ª TESTING SQL FILTER GENERATION")
    print("=" * 50)
    
    test_date = date(2025, 6, 10)
    test_crimes = ["MV Theft", "Burglary - Auto", "Robbery"]
    
    for crime in test_crimes:
        print(f"\nğŸ” Testing {crime}:")
        pattern = get_sql_pattern_for_crime(crime)
        print(f"   SQL Pattern: {pattern}")
    
    print("=" * 50)
    print("âœ… SQL filter test complete!") # =============================================================================
# MAIN EXECUTION
# =============================================================================

if __name__ == "__main__":
    # Run the comprehensive test when this file is executed directly
    quick_config_test()
    print("\n" + "=" * 60)
    test_excel_integration()
    test_sql_filter_generation()
````

## âœ… **Replace your current config.py with the complete version above**

Your current file is missing:
- âŒ All the Excel integration functions (`get_excel_report_name`, `get_7day_period_dates`, etc.) - âŒ The `CRIME_FOLDER_MAPPING` variable  
- âŒ The `EXCEL_CYCLE_PATH` variable
- âŒ All the import statements

## ğŸ§ª **Test Your Updated Config:**

After replacing your config.py with the complete version above, run:

```bash
python config.py
```

**Expected output:**
```
âœ… Excel Cycle File
âœ… Report Base Directory
âœ… ArcGIS Pro Project
âœ… Main PowerPoint Template  
âœ… 7-Day PowerPoint Template

ğŸ“‹ Report name: C06W23
ğŸ“ Folder name: C06W23_2025_06_10_7Day
ğŸ“Š 7-Day period: 2025-06-03 to 2025-06-09
ğŸ‰ ALL TESTS PASSED! CONFIG IS READY! ```

The complete version above includes **everything** you need - all the Excel functions plus the corrected paths! ## Prompt:
6/10/2025, 12:56:04 PM

do i run the test in  the python window or command prompt



## Response:
6/10/2025, 12:56:17 PM

You can run the test in **either** location, but here are the best options:

## ğŸ¯ **Recommended: Command Prompt/Terminal**

**Open Command Prompt and navigate to your project folder:**
```bash
cd "C:\Users\carucci_r\OneDrive - City of Hackensack\_25_SCRPA\TIME_Based\7_Day_Templet_SCRPA_Time"
python config.py
```

## ğŸ **Alternative: Python Console/Window**

**If using Python console or IDLE:**
```python
import config
config.quick_config_test()
```

## ğŸ”§ **ArcGIS Pro Python Window**

**If using ArcGIS Pro's Python window:**
```python
import sys
sys.path.append(r"C:\Users\carucci_r\OneDrive - City of Hackensack\_25_SCRPA\TIME_Based\7_Day_Templet_SCRPA_Time")
import config
config.quick_config_test()
```

## ğŸ¯ **I Recommend: Command Prompt**

The **command prompt** is best because:
- âœ… Shows all the colorful output properly  
- âœ… Displays file paths clearly
- âœ… Easy to see any error messages
- âœ… Most reliable for testing

**Steps:**
1. **Open Command Prompt** (Win + R â†’ `cmd`)
2. **Navigate** to your script folder
3. **Run**: `python config.py`
4. **Check results** - should show all green checkmarks! Which method would you prefer to use? ## Prompt:
6/10/2025, 12:57:57 PM

!