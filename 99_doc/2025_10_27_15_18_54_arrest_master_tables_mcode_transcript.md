# Arrest Master Tables Mcode

**Processing Date:** 2025-10-27 15:18:54
**Source File:** arrest_master_tables_mcode.txt
**Total Chunks:** 1

---

Monthly_Arrest_Summary Table
Sex	Residency Status	Age Group	Nibrs Description	Total Arrests
			Total	1477
F	Local	Adult	 Aggravated Assault (Return A- 4a - 4d)	6
F	Local	Adult	 All Other Offenses	51
F	Local	Adult	 Disorderly Conduct	5
F	Local	Adult	 Driving Under the Influence	7
F	Local	Adult	 Fraud	1
F	Local	Adult	 Larceny - Theft (Except Motor Vehicle Theft)	35
F	Local	Adult	 Offenses Against Children	1
F	Local	Adult	 Opium or Cocaine and their Derivatives (Morphine, Heroin, Codeine)	5
F	Local	Adult	 Robbery	1
F	Local	Adult	 Simple Assault (Return A - 4e)	19
F	Local	Adult	 Stolen Property; Buying, Receiving, Possessing	1
F	Local	Adult	 Synthetic Narcotics - Manufactured Narcotics	1
F	Local	Adult	 Weapons; Carrying, Possessing, Etc. 1
F	Local	Adult	Unknown	1
F	Local	Juvenile	 Aggravated Assault (Return A- 4a - 4d)	1
F	Local	Juvenile	 Burglary	1
F	Local	Juvenile	 Larceny - Theft (Except Motor Vehicle Theft)	1
F	Local	Juvenile	 Weapons; Carrying, Possessing, Etc. 1
F	Local	Middle_Age	 Aggravated Assault (Return A- 4a - 4d)	9
F	Local	Middle_Age	 All Other Offenses	10
F	Local	Middle_Age	 Burglary	1
F	Local	Middle_Age	 Driving Under the Influence	2
F	Local	Middle_Age	 Fraud	1
F	Local	Middle_Age	 Larceny - Theft (Except Motor Vehicle Theft)	15
F	Local	Middle_Age	 Marijuana, Hashish, etc. 1
F	Local	Middle_Age	 Opium or Cocaine and their Derivatives (Morphine, Heroin, Codeine)	2
F	Local	Middle_Age	 Simple Assault (Return A - 4e)	4
F	Local	Middle_Age	 Weapons; Carrying, Possessing, Etc. 2
F	Local	Middle_Age	Unknown	3
F	Local	Senior	 All Other Offenses	4
F	Local	Senior	 Larceny - Theft (Except Motor Vehicle Theft)	7
F	Local	Senior	 Simple Assault (Return A - 4e)	1
F	Local	Young_Adult	 Aggravated Assault (Return A- 4a - 4d)	3
F	Local	Young_Adult	 All Other Offenses	12
F	Local	Young_Adult	 Burglary	3
F	Local	Young_Adult	 Driving Under the Influence	2
F	Local	Young_Adult	 Forgery and Counterfeiting	1
F	Local	Young_Adult	 Larceny - Theft (Except Motor Vehicle Theft)	17
F	Local	Young_Adult	 Simple Assault (Return A - 4e)	10
F	Local	Young_Adult	Unknown	2
F	Out Of County	Adult	 All Other Offenses	2
F	Out Of County	Adult	 Disorderly Conduct	1
F	Out Of County	Adult	 Larceny - Theft (Except Motor Vehicle Theft)	1
F	Out Of County	Middle_Age	 All Other Offenses	3
F	Out Of State	Adult	 Aggravated Assault (Return A- 4a - 4d)	1
F	Out Of State	Adult	 All Other Offenses	6
F	Out Of State	Adult	 Driving Under the Influence	3
F	Out Of State	Adult	 Forgery and Counterfeiting	2
F	Out Of State	Adult	 Larceny - Theft (Except Motor Vehicle Theft)	5
F	Out Of State	Adult	 Opium or Cocaine and their Derivatives (Morphine, Heroin, Codeine)	2
F	Out Of State	Adult	 Robbery	1
F	Out Of State	Adult	 Stolen Property; Buying, Receiving, Possessing	2
F	Out Of State	Adult	ABUSE VIOLATIONS	1
F	Out Of State	Middle_Age	 All Other Offenses	3
F	Out Of State	Middle_Age	 Larceny - Theft (Except Motor Vehicle Theft)	1
F	Out Of State	Young_Adult	 Aggravated Assault (Return A- 4a - 4d)	1
F	Out Of State	Young_Adult	 Larceny - Theft (Except Motor Vehicle Theft)	4
F	Out Of State	Young_Adult	 Robbery	1
F	Out Of State	Young_Adult	 Weapons; Carrying, Possessing, Etc. 1
F	Unknown	Unknown	 Aggravated Assault (Return A- 4a - 4d)	1
F	Unknown	Unknown	 All Other Offenses	2
F	Unknown	Unknown	 Simple Assault (Return A - 4e)	8
M	Local	Adult	 Aggravated Assault (Return A- 4a - 4d)	38
M	Local	Adult	 All Other Offenses	232
M	Local	Adult	 Burglary	16
M	Local	Adult	 Criminal/Malicious Mischief	1
M	Local	Adult	 Disorderly Conduct	14
M	Local	Adult	 Driving Under the Influence	41
M	Local	Adult	 Fraud	2
M	Local	Adult	 Larceny - Theft (Except Motor Vehicle Theft)	25
M	Local	Adult	 Marijuana, Hashish, etc. 7
M	Local	Adult	 Motor Vehicle Theft	1
M	Local	Adult	 Opium or Cocaine and their Derivatives (Morphine, Heroin, Codeine)	17
M	Local	Adult	 Rape	2
M	Local	Adult	 Robbery	9
M	Local	Adult	 Sex Offenses (Except Rape and Prostitution)	5
M	Local	Adult	 Simple Assault (Return A - 4e)	51
M	Local	Adult	 Stolen Property; Buying, Receiving, Possessing	7
M	Local	Adult	 Weapons; Carrying, Possessing, Etc. 10
M	Local	Adult	Unknown	8
M	Local	Juvenile	 Aggravated Assault (Return A- 4a - 4d)	1
M	Local	Juvenile	 All Other Offenses	7
M	Local	Juvenile	 Larceny - Theft (Except Motor Vehicle Theft)	1
M	Local	Juvenile	 Marijuana, Hashish, etc. 5
M	Local	Juvenile	 Robbery	1
M	Local	Juvenile	 Sex Offenses (Except Rape and Prostitution)	1
M	Local	Juvenile	 Simple Assault (Return A - 4e)	1
M	Local	Juvenile	 Stolen Property; Buying, Receiving, Possessing	2
M	Local	Juvenile	 Weapons; Carrying, Possessing, Etc. 8
M	Local	Juvenile	Unknown	5
M	Local	Middle_Age	 Aggravated Assault (Return A- 4a - 4d)	12
M	Local	Middle_Age	 All Other Offenses	62
M	Local	Middle_Age	 Arson	1
M	Local	Middle_Age	 Burglary	5
M	Local	Middle_Age	 Criminal/Malicious Mischief	1
M	Local	Middle_Age	 Disorderly Conduct	2
M	Local	Middle_Age	 Driving Under the Influence	14
M	Local	Middle_Age	 Larceny - Theft (Except Motor Vehicle Theft)	19
M	Local	Middle_Age	 Marijuana, Hashish, etc. 1
M	Local	Middle_Age	 Motor Vehicle Theft	5
M	Local	Middle_Age	 Opium or Cocaine and their Derivatives (Morphine, Heroin, Codeine)	6
M	Local	Middle_Age	 Robbery	1
M	Local	Middle_Age	 Sex Offenses (Except Rape and Prostitution)	3
M	Local	Middle_Age	 Simple Assault (Return A - 4e)	9
M	Local	Middle_Age	 Stolen Property; Buying, Receiving, Possessing	3
M	Local	Middle_Age	 Weapons; Carrying, Possessing, Etc. 4
M	Local	Middle_Age	Unknown	9
M	Local	Senior	 Aggravated Assault (Return A- 4a - 4d)	2
M	Local	Senior	 All Other Offenses	12
M	Local	Senior	 Burglary	1
M	Local	Senior	 Driving Under the Influence	3
M	Local	Senior	 Larceny - Theft (Except Motor Vehicle Theft)	1
M	Local	Senior	 Opium or Cocaine and their Derivatives (Morphine, Heroin, Codeine)	2
M	Local	Senior	 Sex Offenses (Except Rape and Prostitution)	1
M	Local	Senior	 Simple Assault (Return A - 4e)	4
M	Local	Senior	 Weapons; Carrying, Possessing, Etc. 1
M	Local	Young_Adult	 Aggravated Assault (Return A- 4a - 4d)	2
M	Local	Young_Adult	 All Other Offenses	45
M	Local	Young_Adult	 Burglary	3
M	Local	Young_Adult	 Criminal/Malicious Mischief	1
M	Local	Young_Adult	 Disorderly Conduct	5
M	Local	Young_Adult	 Driving Under the Influence	4
M	Local	Young_Adult	 Larceny - Theft (Except Motor Vehicle Theft)	8
M	Local	Young_Adult	 Marijuana, Hashish, etc. 2
M	Local	Young_Adult	 Motor Vehicle Theft	1
M	Local	Young_Adult	 Opium or Cocaine and their Derivatives (Morphine, Heroin, Codeine)	1
M	Local	Young_Adult	 Rape	1
M	Local	Young_Adult	 Robbery	3
M	Local	Young_Adult	 Sex Offenses (Except Rape and Prostitution)	1
M	Local	Young_Adult	 Simple Assault (Return A - 4e)	11
M	Local	Young_Adult	 Stolen Property; Buying, Receiving, Possessing	3
M	Local	Young_Adult	 Weapons; Carrying, Possessing, Etc. 9
M	Local	Young_Adult	Unknown	3
M	Out Of County	Adult	 Aggravated Assault (Return A- 4a - 4d)	1
M	Out Of County	Adult	 All Other Offenses	11
M	Out Of County	Adult	 Disorderly Conduct	1
M	Out Of County	Adult	 Larceny - Theft (Except Motor Vehicle Theft)	2
M	Out Of County	Adult	 Opium or Cocaine and their Derivatives (Morphine, Heroin, Codeine)	3
M	Out Of County	Adult	 Weapons; Carrying, Possessing, Etc. 1
M	Out Of County	Middle_Age	 Aggravated Assault (Return A- 4a - 4d)	1
M	Out Of County	Middle_Age	 All Other Offenses	5
M	Out Of County	Middle_Age	 Larceny - Theft (Except Motor Vehicle Theft)	2
M	Out Of County	Middle_Age	 Simple Assault (Return A - 4e)	1
M	Out Of County	Middle_Age	Unknown	2
M	Out Of County	Senior	 All Other Offenses	1
M	Out Of State	Adult	 Aggravated Assault (Return A- 4a - 4d)	4
M	Out Of State	Adult	 All Other Offenses	31
M	Out Of State	Adult	 Burglary	10
M	Out Of State	Adult	 Disorderly Conduct	1
M	Out Of State	Adult	 Driving Under the Influence	5
M	Out Of State	Adult	 Forgery and Counterfeiting	2
M	Out Of State	Adult	 Fraud	2
M	Out Of State	Adult	 Larceny - Theft (Except Motor Vehicle Theft)	13
M	Out Of State	Adult	 Offenses Against Children	1
M	Out Of State	Adult	 Opium or Cocaine and their Derivatives (Morphine, Heroin, Codeine)	1
M	Out Of State	Adult	 Robbery	2
M	Out Of State	Adult	 Sex Offenses (Except Rape and Prostitution)	1
M	Out Of State	Adult	 Simple Assault (Return A - 4e)	9
M	Out Of State	Adult	 Stolen Property; Buying, Receiving, Possessing	2
M	Out Of State	Adult	 Weapons; Carrying, Possessing, Etc. 3
M	Out Of State	Adult	Unknown	1
M	Out Of State	Juvenile	 All Other Offenses	2
M	Out Of State	Juvenile	 Weapons; Carrying, Possessing, Etc. 1
M	Out Of State	Middle_Age	 Aggravated Assault (Return A- 4a - 4d)	2
M	Out Of State	Middle_Age	 All Other Offenses	2
M	Out Of State	Middle_Age	 Driving Under the Influence	2
M	Out Of State	Middle_Age	 Larceny - Theft (Except Motor Vehicle Theft)	7
M	Out Of State	Middle_Age	 Simple Assault (Return A - 4e)	2
M	Out Of State	Middle_Age	 Stolen Property; Buying, Receiving, Possessing	1
M	Out Of State	Middle_Age	 Synthetic Narcotics - Manufactured Narcotics	1
M	Out Of State	Middle_Age	 Weapons; Carrying, Possessing, Etc. 2
M	Out Of State	Senior	 Driving Under the Influence	1
M	Out Of State	Senior	 Larceny - Theft (Except Motor Vehicle Theft)	1
M	Out Of State	Young_Adult	 Aggravated Assault (Return A- 4a - 4d)	1
M	Out Of State	Young_Adult	 All Other Offenses	5
M	Out Of State	Young_Adult	 Disorderly Conduct	2
M	Out Of State	Young_Adult	 Driving Under the Influence	2
M	Out Of State	Young_Adult	 Larceny - Theft (Except Motor Vehicle Theft)	5
M	Out Of State	Young_Adult	 Marijuana, Hashish, etc. 1
M	Out Of State	Young_Adult	 Robbery	2
M	Out Of State	Young_Adult	 Simple Assault (Return A - 4e)	2
M	Out Of State	Young_Adult	 Weapons; Carrying, Possessing, Etc. 1
M	Unknown	Adult	 Disorderly Conduct	1
M	Unknown	Middle_Age	 All Other Offenses	1
M	Unknown	Unknown	 Aggravated Assault (Return A- 4a - 4d)	9
M	Unknown	Unknown	 All Other Offenses	8
M	Unknown	Unknown	 Burglary	1
M	Unknown	Unknown	 Robbery	1
M	Unknown	Unknown	 Simple Assault (Return A - 4e)	24
M	Unknown	Unknown	 Weapons; Carrying, Possessing, Etc. 1
M	Unknown	Unknown	Unknown	1
M	Unknown	Young_Adult	 Larceny - Theft (Except Motor Vehicle Theft)	1
Unknown	Unknown	Unknown	 Aggravated Assault (Return A- 4a - 4d)	18
Unknown	Unknown	Unknown	 All Other Offenses	43
Unknown	Unknown	Unknown	 Burglary	2
Unknown	Unknown	Unknown	 Criminal/Malicious Mischief	2
Unknown	Unknown	Unknown	 Larceny - Theft (Except Motor Vehicle Theft)	1
Unknown	Unknown	Unknown	 Offenses Against Children	1
Unknown	Unknown	Unknown	 Opium or Cocaine and their Derivatives (Morphine, Heroin, Codeine)	1
Unknown	Unknown	Unknown	 Robbery	2
Unknown	Unknown	Unknown	 Simple Assault (Return A - 4e)	82
Unknown	Unknown	Unknown	 Stolen Property; Buying, Receiving, Possessing	1
Unknown	Unknown	Unknown	 Weapons; Carrying, Possessing, Etc. 4


=================================================
Arrest_Master table
file_year_month	case_number	name	dob	ssn_calc	age	address	race_code	race_description	sex	arrest_date	place_of_arrest	charge	officer_of_record	juvenile_flag	nibrs_code	nibrs_description	reviewed	last_name	first_name	suffix	age_group	statute_2c	charge_description	arrest_year	arrest_month_name	arrest_day_of_week	is_weekend	badge_number	place_missing	squad	assignment
2025_05	25-035624	Molina, Ryan	33894	113-80-8081	32	680 St Nicholas Aven, New York, NY 10030	2A	    Black Hisp. M	05/01/25		Driving While Intoxicated   39:4-50	P.O. Anzour Marza 356		210	 Driving Under the Influence	127	Molina	Ryan		adult		Driving While Intoxicated   39:4-50	2025	May	Thursday	FALSE	356	FALSE	A3	Patrol
2023_Al	23-015181	Cruz-Dellvalle, Eddie	35301		26	33 Henry Place Apt.B4, Hackensack, NJ 07601	1A	    White Hisp. M	02/14/23	33 Henry Place Apt.B4, Hackensack, NJ 07601	Service of Warrant	P.O. Anzour Marza 356		260	 All Other Offenses	141	Cruz-Dellvalle	Eddie		adult		Service of Warrant	2023	February	Tuesday	FALSE	356	FALSE	A3	Patrol
2025_05	25-035743	Mateo, Kevin	36945	144-08-9370	24	405 Hudson Street 2nd Floor, Hackensack, NJ 07601	1A	    White Hisp. M	05/01/25		Service of Warrant	P.O. Carmine Maceri 378		260	 All Other Offenses	Levis R	Mateo	Kevin		young_adult		Service of Warrant	2025	May	Thursday	FALSE	378	FALSE	A3	Patrol
2025_05	25-035868	Shine, Matese	29748	247-69-4565	43	185 Central Ave Apt 2B, Hackensack, NJ 07601	2A	    Black Hisp. F	05/02/25		2A:10-1 Arrest on Warrant	P.O. Paula Lopez 362		260	 All Other Offenses	Levis R	Shine	Matese		adult		2A:10-1 Arrest on Warrant	2025	May	Friday	FALSE	362	FALSE	A2	Patrol
2025_05	25-036545	Covington, Iyanah	34784	141-98-6675	30	156 Washington Ave, Little Ferry, NJ 07643-2094	2B	    Black Non-Hisp. F	05/04/25		Disorderly Conduct  2C:33-2 	P.O. Paula Lopez 362		240	 Disorderly Conduct	Tripodi F	Covington	Iyanah		adult		Disorderly Conduct  2C:33-2 	2025	May	Sunday	TRUE	362	FALSE	A2	Patrol
2025_05	25-043528	Calichs, Alyssa	35701	158-02-0825	27	199 Bergen Tpk, Ridgefield Park, NJ 07660	1A	    White Hisp. F	05/27/25		Shoplifting  2C:20-11	P.O. Paula Lopez 362		060	 Larceny - Theft (Except Motor Vehicle Theft)	Competiello Fa	Calichs	Alyssa		adult		Shoplifting  2C:20-11	2025	May	Tuesday	FALSE	362	FALSE	A2	Patrol
2023_Al	23-000445	Frye, Jermaine	27351	418-19-9006	48	Homeless	2B	    Black Non-Hisp. M	01/02/23	Hudson/Broadway	Aggravated Assault  2C:12-1b	P.O. Paula Luppino 362		040	 Aggravated Assault (Return A- 4a - 4d)	162	Frye	Jermaine		middle_age		Aggravated Assault  2C:12-1b	2023	January	Monday	FALSE	362	FALSE	A2	Patrol
2023_Al	23-010168	Bernal-Herrera, Jesus	35865		24	7335 192nd Street, Queens, NY 11366	1A	    White Hisp. M	01/30/23	380 West Pleasantview Avenue 	2C:20-11	P.O. Paula Luppino 362		060	 Larceny - Theft (Except Motor Vehicle Theft)	141	Bernal-Herrera	Jesus		young_adult		2C:20-11	2023	January	Monday	FALSE	362	FALSE	A2	Patrol
2025_05	25-036023	Fonseca, Esperanza	31804	082-92-0590	38	150 Main Street, Apt. #630, Hackensack NJ 07601	1A	    White Hisp. F	05/02/25		Simple Assault  2C:12-1a  	P.O. Nart Marza 321		080	 Simple Assault (Return A - 4e)	Gretkowski J	Fonseca	Esperanza		adult		Simple Assault  2C:12-1a  	2025	May	Friday	FALSE	321	FALSE	A1	Patrol
2025_05	25-036060	Flores-Figueroa, Luis	24894	155-70-0580	57	192 Fabian Place, Newark, NJ	1A	    White Hisp. M	05/02/25		CDS/Possession: Influence  2C:35-10	Det. Michael Reo 339		186	 Opium or Cocaine and their Derivatives (Morphine, Heroin, Codeine)	Seretis P	Flores-Figueroa	Luis		middle_age		CDS/Possession: Influence  2C:35-10	2025	May	Friday	FALSE	339	FALSE	CSB	Crime Suppression Bureau
2025_05	25-044445	Jakubowski, Krzysztof	27784	070-92-9100	49	154 Newell Street, Brooklyn, NY 11222	1B	    White Non Hisp. M	05/30/25		Receiving Stolen Property  2C:20-7a	Det. Michael Reo 339		130	 Stolen Property; Buying, Receiving, Possessing	Seretis P	Jakubowski	Krzysztof		middle_age		Receiving Stolen Property  2C:20-7a	2025	May	Friday	FALSE	339	FALSE	CSB	Crime Suppression Bureau
2023_Al	23-015410	Decandia, Charles	24262	145-68-2685	56	2108 Candlelight Court, Helmetta, NJ 08828	1B	    White Non Hisp. M	02/14/23	225 State Street Hackensack NJ 07601	Service of Warrant	Det. Michael Reo 339		260	 All Other Offenses	110	Decandia	Charles		middle_age		Service of Warrant	2023	February	Tuesday	FALSE	339	FALSE	CSB	Crime Suppression Bureau
2023_Al	23-017788	Murphy, Zakee	33097	139-90-1796	32	170 Cambridge Avenue apt 2 Garfield, NJ 07607	1B	    White Non Hisp. M	02/21/23	Central Avenue & Railroad Hackensack NJ 07601	2c:35-10a(1)	P.O. Michael Reo 339				105	Murphy	Zakee		adult		2c:35-10a(1)	2023	February	Tuesday	FALSE	339	FALSE	CSB	Crime Suppression Bureau
2023_Al	23-018782	NO RECORDS								02/25/23	25 Grand Avenue 7G, Hackensack, NJ 07601	Simple Assault  2C:12-1a  	P.O. Michael Reo 339		080	 Simple Assault (Return A - 4e)	110	NO RECORDS					Simple Assault  2C:12-1a  	2023	February	Saturday	TRUE	339	FALSE	CSB	Crime Suppression Bureau
2023_Al	23-019027	Peak, Ebony	28558	096-64-7448	44	24 Amity St, Paterson, NJ 07522	2B	    Black Non-Hisp. F	02/26/23	170 Prospect Avenue, Hackensack NJ 07601	2C:20-7 	P.O. Michael Reo 339		130	 Stolen Property; Buying, Receiving, Possessing	140	Peak	Ebony		adult		2C:20-7 	2023	February	Sunday	TRUE	339	FALSE	CSB	Crime Suppression Bureau
2025_05	25-035185	Gilliam, Arthur	28703	077-62-4932	46	100 Essex Street, Hackensack, NJ 07601	2B	    Black Non-Hisp. M	05/02/25		2C:21-6d(2)	Det. Matthew Dogali 338		060	 Larceny - Theft (Except Motor Vehicle Theft)	Williams P	Gilliam	Arthur		middle_age		2C:21-6d(2)	2025	May	Friday	FALSE	338	FALSE	DET	Detectives
2025_05	25-022893	Gonell, Marykelis	33269	140-19-2524	34	15 18th Street Apt. 2, Paterson, NJ 07513	1A	    White Hisp. F	05/15/25		2C:21-1a(3)	Det. Matthew Dogali 338		110	 Fraud	Williams P	Gonell	Marykelis		adult		2C:21-1a(3)	2025	May	Thursday	FALSE	338	FALSE	DET	Detectives
2023_Al	23-000077	Drakeford, Gary	35826	138-04-5666	24	245 James Street, Hackensack, NJ 07601-3419	2B	    Black Non-Hisp. M	01/01/23	245 James Street, Hackensack, NJ 07601	Simple Assault  2C:12-1a  	P.O. Matthew Dogali 338		080	 Simple Assault (Return A - 4e)	273	Drakeford	Gary		young_adult		Simple Assault  2C:12-1a  	2023	January	Sunday	TRUE	338	FALSE	DET	Detectives
2025_05	25-036252	Laramora, Edgar	31268		39	67 South State Street, Hackensack, NJ 07601	1A	    White Hisp. M	05/03/25		39:4-50	P.O. Massimo Gallorini 379		210	 Driving Under the Influence	Butler J	Laramora	Edgar		adult	
=======================================================================================
let
    // Load Arrest files
    folderPath = "C:\Users\carucci_r\OneDrive - City of Hackensack\_LawSoft_EXPORT\Arrest",
    Source = Folder.Files(folderPath),
    FilteredFiles = Table.SelectRows(Source, each Text.EndsWith([Name], "_Arrests.xlsx")),
    AddFileDate = Table.AddColumn(FilteredFiles, "file_year_month", each Text.Start([Name], 7)),

    GetSheet1 = (fileBinary as binary) =>
        let
            wb = Excel.Workbook(fileBinary, null, true),
            sheet = wb{[Item="Sheet1", Kind="Sheet"]}[Data],
            promoted = Table.PromoteHeaders(sheet, [PromoteAllScalars=true])
        in promoted,

    AddData = Table.AddColumn(AddFileDate, "Data", each GetSheet1([Content])),
    Pruned = Table.SelectColumns(AddData, {"file_year_month", "Data"}),
    Expanded = Table.ExpandTableColumn(Pruned, "Data", {
        "Case Number", "Name", "DOB", "SS#Calc", "Age", "Address", "Race", "Sex",
        "Arrest Date", "Place of Arrest", "Charge", "Officer of Record",
        "ReportCalcSummary", "JuvenileFlag", "UCR #", "Reviewed"
    }),

    // Rename to snake_case and remove report_calc_summary
    Renamed = Table.RenameColumns(
        Table.RemoveColumns(Expanded, {"ReportCalcSummary"}),
        {
            {"Case Number", "case_number"},
            {"Name", "name"},
            {"DOB", "dob"},
            {"SS#Calc", "ssn_calc"},
            {"Age", "age"},
            {"Address", "address"},
            {"Race", "race"},
            {"Sex", "sex"},
            {"Arrest Date", "arrest_date"},
            {"Place of Arrest", "place_of_arrest"},
            {"Charge", "charge"},
            {"Officer of Record", "officer_of_record"},
            {"JuvenileFlag", "juvenile_flag"},
            {"UCR #", "ucr_code"},
            {"Reviewed", "reviewed"}
        }
    ),

    // Trim only actual text columns using safe type checking
    textColumns = List.Select(Table.ColumnNames(Renamed), (col) =>
        try Type.Is(Value.Type(Renamed{0}[col]), type text) otherwise false
    ),
    Trimmed = Table.TransformColumns(Renamed, List.Transform(textColumns, each {_, Text.Trim, type text})),

    // Name parsing
    NameParts = Table.AddColumn(Trimmed, "name_parts", each Text.Split([name], ", ")),
    WithLastName = Table.AddColumn(NameParts, "last_name", each try [name_parts]{0} otherwise null),
    WithFirstSuffix = Table.AddColumn(WithLastName, "first_suffix_raw", each try [name_parts]{1} otherwise null),
    CleanedNames = Table.RemoveColumns(WithFirstSuffix, {"name_parts"}),

    AddFirstName = Table.AddColumn(CleanedNames, "first_name", each try Text.BeforeDelimiter([first_suffix_raw], " ") otherwise [first_suffix_raw]),
    AddSuffixRaw = Table.AddColumn(AddFirstName, "suffix_raw", each try Text.AfterDelimiter([first_suffix_raw], " ") otherwise null),
    ValidSuffix = {"Jr.", "Sr.", "II", "III", "IV"},
    SuffixChecked = Table.AddColumn(AddSuffixRaw, "suffix", each if List.Contains(ValidSuffix, [suffix_raw]) then [suffix_raw] else null),
    RemoveTemp = Table.RemoveColumns(SuffixChecked, {"first_suffix_raw", "suffix_raw"}),

    // Age Group with null protection
    AddAgeGroup = Table.AddColumn(RemoveTemp, "age_group", each 
        if [age] = null then null else 
        if [age] <= 12 then "child"
        else if [age] <= 17 then "juvenile"
        else if [age] <= 24 then "young_adult"
        else if [age] <= 44 then "adult"
        else if [age] <= 64 then "middle_age"
        else "senior", type text),

    // Race split
    SplitRace = Table.SplitColumn(AddAgeGroup, "race", Splitter.SplitTextByEachDelimiter({" "}, 1, false), {"race_code", "race_description"}),

    // Charge â†’ statute and description
    AddStatute = Table.AddColumn(SplitRace, "statute_2c", each try Text.Middle(Text.Select([charge], {"0".."9", "A".."Z", "a".."z", ":", "-"}), Text.PositionOfAny([charge], {"2C"}), 10) otherwise null),
    AddChargeDesc = Table.AddColumn(AddStatute, "charge_description", each try Text.BeforeDelimiter([charge], [statute_2c]) otherwise [charge]),

    // Arrest date breakdown
    ConvertArrestDate = Table.TransformColumnTypes(AddChargeDesc, {{"arrest_date", type date}}),
    AddArrestYear = Table.AddColumn(ConvertArrestDate, "arrest_year", each Date.Year([arrest_date]), Int64.Type),
    AddArrestMonth = Table.AddColumn(AddArrestYear, "arrest_month_name", each Date.MonthName([arrest_date]), type text),
    AddArrestDay = Table.AddColumn(AddArrestMonth, "arrest_day_of_week", each Date.DayOfWeekName([arrest_date]), type text),
    AddIsWeekend = Table.AddColumn(AddArrestDay, "is_weekend", each let d = Date.DayOfWeek([arrest_date]) in d = 0 or d = 6, type logical),

    // Officer badge number
    AddBadge = Table.AddColumn(AddIsWeekend, "badge_number", each try Text.Select(List.Last(Text.Split([officer_of_record], " ")), {"0".."9"}) otherwise null, type text),

    // Reviewed cleaned
    CleanReviewed = Table.TransformColumns(AddBadge, {{"reviewed", each Text.Proper(Text.Replace(_, "_", " ")), type text}}),

    // NIBRS split
    SplitUCR = Table.SplitColumn(CleanReviewed, "ucr_code", Splitter.SplitTextByEachDelimiter({" "}, 1, false), {"nibrs_code", "nibrs_description"}),

    // Place missing flag
    AddPlaceMissing = Table.AddColumn(SplitUCR, "place_missing", each Text.Trim([place_of_arrest]) = "", type logical),

    // === Load and clean ASSIGNMENT_MASTER ===
    AssignmentSource = Excel.Workbook(File.Contents("C:\Users\carucci_r\OneDrive - City of Hackensack\_Hackensack_Data_Repository\ASSIGNED_SHIFT\ASSIGNMENT_MASTER.xlsx"), null, true),
    AssignmentSheet = AssignmentSource{[Item="ASSIGNMENT_MASTER", Kind="Sheet"]}[Data],
    PromoteHeaders = Table.PromoteHeaders(AssignmentSheet, [PromoteAllScalars=true]),
    TypeAdjusted = Table.TransformColumnTypes(PromoteHeaders, {
        {"BADGE_NUMBER", type text},
        {"Squad", type text},
        {"ASSIGNMENT", type text}
    }),
    AssignmentClean = Table.TransformColumns(TypeAdjusted, {{"BADGE_NUMBER", each Text.From(_), type text}}),

    // Ensure badge number columns are text
    ArrestWithTextBadge = Table.TransformColumnTypes(AddPlaceMissing, {{"badge_number", type text}}),

    // Join
    Joined = Table.NestedJoin(ArrestWithTextBadge, "badge_number", AssignmentClean, "BADGE_NUMBER", "assignment_data", JoinKind.LeftOuter),
    ExpandAssign = Table.ExpandTableColumn(Joined, "assignment_data", {"Squad", "ASSIGNMENT"}),

    // Rename joined columns to snake_case
    FinalRenamed = Table.RenameColumns(ExpandAssign, {
        {"Squad", "squad"},
        {"ASSIGNMENT", "assignment"}
    })
in
    FinalRenamed
	
====================================================================
let
    // Use existing query as input
    Source = Arrest_Master,

    // Use raw columns and rename them explicitly
    RenamedColumns = Table.RenameColumns(Source, {
        {"Column7", "address"},
        {"Column10", "sex"},
        {"Column13", "nibrs_description"},
        {"Column23", "age_group"}
    }, MissingField.Ignore),

    // Remove completely empty rows
    RemovedEmpty = Table.SelectRows(RenamedColumns, each List.NonNullCount(Record.FieldValues(_)) > 0),

    // Standardize header casing to lowercase
    LowercaseHeaders = Table.RenameColumns(RemovedEmpty, List.Transform(Table.ColumnNames(RemovedEmpty), each {_, Text.Lower(_)})),

    // Replace empty strings with nulls in relevant columns
    Cleaned = Table.TransformColumns(LowercaseHeaders, {
        {"sex", each if Text.Trim(_) = "" then null else _, type nullable text},
        {"address", each if Text.Trim(_) = "" then null else _, type nullable text},
        {"age_group", each if Text.Trim(_) = "" then null else _, type nullable text},
        {"nibrs_description", each if Text.Trim(_) = "" then null else _, type nullable text}
    }),

    // Validate required columns exist
    RequiredCols = {"sex", "address", "age_group", "nibrs_description"},
    ActualCols = Table.ColumnNames(Cleaned),
    MissingCols = List.Difference(RequiredCols, ActualCols),
    ValidateColumns = if List.Count(MissingCols) > 0 then
        error "Missing expected columns: " & Text.Combine(MissingCols, ", ")
    else
        Cleaned,

    // Change column types
    ChangedTypes = Table.TransformColumnTypes(ValidateColumns, {
        {"sex", type text},
        {"address", type text},
        {"age_group", type text},
        {"nibrs_description", type text}
    }),

    // Add Residency Status logic
    AddResidency = Table.AddColumn(ChangedTypes, "residency_status", each 
        if [address] = null then "Unknown"
        else if Text.Contains(Text.Lower([address]), "homeless") then "Out Of County"
        else if Text.Contains(Text.Lower([address]), "nj") then "Local"
        else "Out Of State",
        type text
    ),

    // Format Age Group values to title case, and replace null with 'Unknown'
    FormatAgeGroup = Table.TransformColumns(AddResidency, {
        {"age_group", each if _ = null then "Unknown" else Text.Proper(_), type text}
    }),

    // Replace nulls in sex and nibrs_description with 'Unknown'
    Normalized = Table.TransformColumns(FormatAgeGroup, {
        {"sex", each if _ = null then "Unknown" else _, type text},
        {"nibrs_description", each if _ = null then "Unknown" else _, type text}
    }),

    // Capitalize output headers
    CapitalizedHeaders = Table.RenameColumns(Normalized, {
        {"sex", "Sex"},
        {"address", "Address"},
        {"age_group", "Age Group"},
        {"nibrs_description", "Nibrs Description"},
        {"residency_status", "Residency Status"}
    }, MissingField.Ignore),

    // Remove rows where all grouping values are "Unknown"
    FilteredRows = Table.SelectRows(CapitalizedHeaders, each not (
        [Sex] = "Unknown" and [Residency Status] = "Unknown" and [Age Group] = "Unknown" and [Nibrs Description] = "Unknown"
    )),

    // Group and summarize by key attributes
    Grouped = Table.Group(FilteredRows, {"Sex", "Residency Status", "Age Group", "Nibrs Description"}, {
        {"Total Arrests", each Table.RowCount(_), Int64.Type}
    }),

    // Add grand total row
    GrandTotal = Table.FromRecords({
        [Sex = null, Residency Status = null, Age Group = null, Nibrs Description = "Total", Total Arrests = List.Sum(Grouped[Total Arrests])]
    }),

    // Append total to bottom
    Combined = Table.Combine({Grouped, GrandTotal}),

    // Sort results for clarity
    Sorted = Table.Sort(Combined, {
        {"Sex", Order.Ascending},
        {"Residency Status", Order.Ascending},
        {"Age Group", Order.Ascending},
        {"Nibrs Description", Order.Ascending}
    })
in
    Sorted

