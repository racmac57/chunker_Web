[IMPORT] os
[IMPORT] glob
[IMPORT] logging
[FROM IMPORT] from datetime import datetime
[FROM IMPORT] from fpdf import FPDF
[FROM IMPORT] from zipfile import ZipFile
[IMPORT] shutil
[FROM IMPORT] from pathlib import Path

[CLASS] ReportPackager
   Methods: __init__, __enter__, __exit__, cleanup_temp_files
   [Description] Class to handle packaging of crime reports into PDF and ZIP formats....

[FUNCTION]: validate_dependencies()
   [Description] Validate that required libraries are available. Returns:
        tuple: (is_valid, list_of_...

[FUNCTION]: clean_old_reports(output_folder, crime_type)
   [Description] Clean up old report files for the given crime type. Args:
        output_folder (str): Dire...

[FUNCTION]: find_report_files(output_folder, crime_type)
   [Description] Find all report files for a given crime type. Args:
        output_folder (str): Directory ...

[FUNCTION]: create_pdf_report(crime_type, files, output_folder, args)
   [Description] Create a PDF report with maps, charts, and data summary. Args:
        crime_type (str): Ty...

[FUNCTION]: create_zip_archive(crime_type, files, pdf_path, output_folder)
   [Description] Create ZIP archive containing all report components. Args:
        crime_type (str): Type o...

[FUNCTION]: package_report(crime_type, output_folder, args)
   [Description] Main function to package charts, maps, and records into PDF and ZIP. Args:
        crime_ty...
[FROM IMPORT] from config import CHART_OUTPUT_DIR, get_sanitized_filename

[MAGIC METHOD]: __init__(self)

[MAGIC METHOD]: __enter__(self)

[MAGIC METHOD]: __exit__(self, exc_type, exc_val, exc_tb)

[FUNCTION]: cleanup_temp_files(self)
   [Description] Clean up any temporary files created during processing....
[VARIABLE]: missing_deps
[VARIABLE]: sanitized_crime
[VARIABLE]: files
[VARIABLE]: chart_patterns
[VARIABLE]: search_dirs
[VARIABLE]: test_crime_type
[VARIABLE]: test_output_folder
[VARIABLE]: success
[CONSTANT]: CHART_OUTPUT_DIR

[FUNCTION]: get_sanitized_filename(text)
[IMPORT] fpdf
[VARIABLE]: sanitized_crime
[VARIABLE]: patterns
[VARIABLE]: cleaned_count
[VARIABLE]: found
[VARIABLE]: sanitized_crime
[VARIABLE]: pdf_path
[VARIABLE]: pdf
[VARIABLE]: report_date
[VARIABLE]: content_summary
[VARIABLE]: sanitized_crime
[VARIABLE]: zip_path
[VARIABLE]: cleaned_count
[VARIABLE]: files
[VARIABLE]: has_files
[VARIABLE]: create_archive
[VARIABLE]: pattern_path
[VARIABLE]: old_files
[VARIABLE]: chart_path
[VARIABLE]: status
[VARIABLE]: files_added
[VARIABLE]: zip_size
[VARIABLE]: create_archive
[VARIABLE]: found
[VARIABLE]: page_width
[IMPORT] pandas
[VARIABLE]: df
[VARIABLE]: create_archive
[VARIABLE]: filename
[VARIABLE]: period_counts
[VARIABLE]: period_name
[VARIABLE]: page_width
[VARIABLE]: period_name
[VARIABLE]: period_name
[VARIABLE]: period_name