[IMPORT] pandas
[IMPORT] numpy
[IMPORT] re
[IMPORT] os
[FROM IMPORT] from datetime import datetime
[IMPORT] tkinter
[FROM IMPORT] from tkinter import filedialog, messagebox
[IMPORT] glob
[IMPORT] zipfile
[FROM IMPORT] from geopy.geocoders import Nominatim
[FROM IMPORT] from geopy.exc import GeocoderTimedOut, GeocoderUnavailable
[IMPORT] time

[CLASS] CADDataEnricher
   Methods: __init__, load_personnel_data, normalize_incident_type, extract_officer_badges, enrich_officer_data, validate_timestamps, validate_addresses, process_cad_file, create_summary_stats, export_results

[FUNCTION]: main()
   [Description] Main execution with GUI...

[MAGIC METHOD]: __init__(self, personnel_file)
   [Description] Initialize with normalized personnel data...

[FUNCTION]: load_personnel_data(self, personnel_file)
   [Description] Load normalized personnel data for officer enrichment...

[FUNCTION]: normalize_incident_type(self, incident)
   [Description] Normalize incident types (from your existing logic)...

[FUNCTION]: extract_officer_badges(self, officer_field)
   [Description] Extract badge numbers from officer fields...

[FUNCTION]: enrich_officer_data(self, df)
   [Description] Enrich CAD data with officer information...

[FUNCTION]: validate_timestamps(self, df)
   [Description] Validate timestamp logic (from your existing script)...

[FUNCTION]: validate_addresses(self, df, geocode_sample)
   [Description] Address validation with optional geocoding...

[FUNCTION]: process_cad_file(self, file_path, lookup_df, output_dir, geocode_sample)
   [Description] Process single CAD file with full enrichment...

[FUNCTION]: create_summary_stats(self, df)
   [Description] Create comprehensive summary statistics...

[FUNCTION]: export_results(self, df, stats, file_path, output_dir)
   [Description] Export enriched data and reports...
[VARIABLE]: root
[VARIABLE]: personnel_file
[VARIABLE]: input_folder
[VARIABLE]: output_dir
[VARIABLE]: clean_str
[VARIABLE]: clean_str
[VARIABLE]: clean_str
[VARIABLE]: clean_str
[VARIABLE]: badges
[VARIABLE]: timestamp_cols
[VARIABLE]: addr_col
[VARIABLE]: df
[VARIABLE]: df
[VARIABLE]: df
[VARIABLE]: df
[VARIABLE]: stats
[VARIABLE]: stats
[VARIABLE]: timestamp
[VARIABLE]: base_name
[VARIABLE]: enriched_file
[VARIABLE]: error_conditions
[VARIABLE]: error_df
[VARIABLE]: summary_df
[VARIABLE]: summary_file
[VARIABLE]: enricher
[VARIABLE]: excel_files
[VARIABLE]: lookup_df
[VARIABLE]: all_stats
[VARIABLE]: master_summary
[VARIABLE]: timestamp
[VARIABLE]: master_file
[VARIABLE]: officers_found
[VARIABLE]: officer_fields
[VARIABLE]: addr
[VARIABLE]: clean_addr
[VARIABLE]: clean_addr
[VARIABLE]: has_number
[VARIABLE]: is_intersection
[VARIABLE]: df
[VARIABLE]: error_file
[VARIABLE]: lookup_df
[VARIABLE]: stats
[VARIABLE]: primary
[VARIABLE]: parts
[VARIABLE]: badge
[VARIABLE]: badges
[VARIABLE]: secondary_names
[VARIABLE]: location