[IMPORT] arcpy
[IMPORT] os
[IMPORT] sys
[IMPORT] argparse
[IMPORT] pandas
[FROM IMPORT] from datetime import datetime
[FROM IMPORT] from pathlib import Path

[FUNCTION]: get_report_name_from_date(target_date_str)
   [Description] Load Excel file and return the corresponding Report_Name for the given date. Args:
        ...

[FUNCTION]: setup_map_and_layouts(aprx_path)
   [Description] Setup ArcGIS Pro project and return map and layout objects....

[FUNCTION]: update_map_extent_and_definition_queries(current_map, args)
   [Description] Update map extent and definition queries based on arguments....

[FUNCTION]: get_crime_type_from_layout_name(layout_name)
   [Description] Extract crime type from layout name to determine subfolder. Args:
        layout_name (str)...

[FUNCTION]: export_layout(layout, main_output_path, layout_name, args)
   [Description] Export a single layout to the appropriate crime-type subfolder as PNG....

[FUNCTION]: run_all_layouts(aprx, current_map, layouts, args)
   [Description] Export all layouts to dynamically generated folder path with crime-type subfolders....

[FUNCTION]: run_specific_layout(aprx, current_map, layouts, layout_name, args)
   [Description] Export a specific layout to dynamically generated folder path with crime-type subfolder....

[FUNCTION]: main()
   [Description] Main function to handle command line arguments and execute appropriate functions....
[VARIABLE]: excel_path
[VARIABLE]: crime_type_mapping
[VARIABLE]: layout_lower
[VARIABLE]: clean_name
[VARIABLE]: clean_name
[VARIABLE]: df
[VARIABLE]: target_date
[VARIABLE]: match
[VARIABLE]: aprx
[VARIABLE]: maps
[VARIABLE]: current_map
[VARIABLE]: layouts
[VARIABLE]: crime_type
[VARIABLE]: crime_subfolder
[VARIABLE]: safe_date
[VARIABLE]: filename
[VARIABLE]: full_path
[VARIABLE]: report_name
[VARIABLE]: safe_date
[VARIABLE]: folder_name
[VARIABLE]: base_output_path
[VARIABLE]: main_output_path
[VARIABLE]: crime_types
[VARIABLE]: crime_subfolder_mapping
[VARIABLE]: exports_by_crime_type
[VARIABLE]: successful_exports
[VARIABLE]: failed_exports
[VARIABLE]: target_layout
[VARIABLE]: report_name
[VARIABLE]: safe_date
[VARIABLE]: folder_name
[VARIABLE]: base_output_path
[VARIABLE]: main_output_path
[VARIABLE]: parser
[VARIABLE]: args
[VARIABLE]: report_name
[VARIABLE]: extent_coords
[VARIABLE]: formatted_date
[VARIABLE]: subfolder_path
[VARIABLE]: result_path
[VARIABLE]: result_path
[VARIABLE]: extent
[VARIABLE]: target_layout
[VARIABLE]: date_query