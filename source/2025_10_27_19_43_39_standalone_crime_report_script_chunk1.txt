[IMPORT] sys
[IMPORT] os
[IMPORT] datetime
[FROM IMPORT] from pathlib import Path
[IMPORT] logging
[VARIABLE]: logger
[CONSTANT]: CRIME_TYPES
[CONSTANT]: SUFFIXES
[CONSTANT]: APR_PATH
[CONSTANT]: BASE_LAYERS
[CONSTANT]: TRANSPARENCY_LEVELS
[CONSTANT]: LAYOUT_TO_CRIME_TYPE

[FUNCTION]: get_report_name_from_date(target_date_str)
   [Description] Load Excel file and return the corresponding Report_Name for the given date....

[FUNCTION]: get_crime_type_subfolder(crime_type)
   [Description] Convert crime type name to a clean subfolder name....

[FUNCTION]: get_crime_type_from_layout_name(layout_name)
   [Description] Extract crime type from layout name based on actual layout names in project....

[FUNCTION]: create_dynamic_folder_structure(base_folder, date_str, crime_types)
   [Description] Create the main folder and crime-type subfolders using dynamic naming....

[FUNCTION]: build_sql_filter(crime_type, start_date)
   [Description] Build SQL filter based on crime type....

[FUNCTION]: configure_map_for_crime_type(current_map, crime_type, date_str)
   [Description] Configure map layers for a specific crime type....

[FUNCTION]: export_single_crime_layout(layout, main_output_path, crime_type, date_str)
   [Description] Export a single crime type layout to its subfolder as PNG....

[FUNCTION]: run_individual_crime_exports(main_folder_path, date_str)
   [Description] Export each crime type individually with proper layer configuration....

[FUNCTION]: main()
   [Description] Main function to handle command line arguments and execute automation....
[IMPORT] arcpy
[IMPORT] pandas
[VARIABLE]: excel_path
[VARIABLE]: crime_type_mapping
[VARIABLE]: crime_lower
[VARIABLE]: clean_name
[VARIABLE]: layout_lower
[VARIABLE]: clean_name
[VARIABLE]: base_conditions
[VARIABLE]: crime_patterns
[VARIABLE]: pattern
[VARIABLE]: sql_filter
[VARIABLE]: df
[VARIABLE]: target_date
[VARIABLE]: match
[VARIABLE]: report_name
[VARIABLE]: main_folder_name
[VARIABLE]: main_folder_path
[VARIABLE]: created_subfolders
[VARIABLE]: conditions
[VARIABLE]: crime_condition
[VARIABLE]: crime_condition
[VARIABLE]: today
[VARIABLE]: dates
[VARIABLE]: subfolder_name
[VARIABLE]: crime_subfolder
[VARIABLE]: safe_date
[VARIABLE]: filename
[VARIABLE]: full_path
[VARIABLE]: aprx
[VARIABLE]: maps
[VARIABLE]: current_map
[VARIABLE]: layouts
[VARIABLE]: crime_layouts
[VARIABLE]: successful_exports
[VARIABLE]: failed_exports
[VARIABLE]: total_layouts
[VARIABLE]: report
[VARIABLE]: dry_run
[VARIABLE]: date_str
[VARIABLE]: base_folder
[VARIABLE]: main_folder_path
[VARIABLE]: report_name
[VARIABLE]: subfolder_name
[VARIABLE]: subfolder_path
[VARIABLE]: fallback_folder
[VARIABLE]: transparency
[VARIABLE]: layer_name
[VARIABLE]: layer
[VARIABLE]: layout_name
[VARIABLE]: success
[VARIABLE]: layer
[VARIABLE]: filter_sql
[VARIABLE]: crime_type
[VARIABLE]: crime_type