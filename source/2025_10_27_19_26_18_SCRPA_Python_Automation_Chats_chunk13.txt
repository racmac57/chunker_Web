The issue now is:

‚ùó New Errors Summary
Map export failed ... list index out of range

Your script expects a layout named "SCRPA_Layout" and a map frame named "Map Frame" inside it. The error means either the layout or the map frame doesn‚Äôt exist by those names in TimeSCRPATemplet.aprx. Data table not found for: [crime_type]

Your script tries to find CSVs in this path:

C:\GIS_Data\SCRPA\tables\<sanitized>.csv
These .csv files don‚Äôt exist at that location. ‚úÖ Next Fixes
To move forward:

A. Fix Layout + MapFrame Names
Open TimeSCRPATemplet.aprx in ArcGIS Pro. Check the layout name:

Should match "SCRPA_Layout" (case-sensitive). Check the map frame name inside that layout:

Should be "Map Frame". ‚úÖ Rename them if needed, or update the script to match actual names. B. Fix Data Table Path
Confirm where your crime CSV tables live. If they are in:

C:\Users\carucci_r\...custom_path...
Update this line in the script:

source_table = f"C:\\GIS_Data\\SCRPA\\tables\\{sanitized}.csv"
To point to the real path, for example:

source_table = os.path.join("C:\\Users\\carucci_r\\OneDrive - City of Hackensack\\_25_SCRPA\\Tables", f"{sanitized}.csv")
‚úÖ Let me know:
Layout name and map frame name from your .aprx

Actual location of the crime data CSVs

And I‚Äôll instantly update your script. You're 90% there! Next suggestions:
a. Enable ‚ÄúSend Emails‚Äù once output works
b. Export full weekly PDF summary alongside PNGs

You said:
Updated Weekly Crime Report
=====================
Tool Path

C:\Users\carucci_r\OneDrive - City of Hackensack\_25_SCRPA\TIME_Based\TimeSCRPATemplet\SCRPA_Exports.tbx\WeeklyCrimeExport
=====================
Parameters

Report Only     true
Send Emails     false
Archive Folders     false
Archive Age Days     30
Dry Run Mode     false
Report Date     2025_05_13
=====================
Messages

Start Time: Tuesday, May 13, 2025 2:44:03 PM
Running reports...
Map export failed for MV_Theft_7_Day: list index out of range
Data table not found for: MV_Theft_7_Day
Map export failed for MV_Theft_28_Day: list index out of range
Data table not found for: MV_Theft_28_Day
Map export failed for MV_Theft_YTD: list index out of range
Data table not found for: MV_Theft_YTD
Map export failed for Burglary_-_Auto_7_Day: list index out of range
Data table not found for: Burglary_-_Auto_7_Day
Map export failed for Burglary_-_Auto_28_Day: list index out of range
Data table not found for: Burglary_-_Auto_28_Day
Map export failed for Burglary_-_Auto_YTD: list index out of range
Data table not found for: Burglary_-_Auto_YTD
Map export failed for Burglary_-_Comm_And_Res_7_Day: list index out of range
Data table not found for: Burglary_-_Comm_And_Res_7_Day
Map export failed for Burglary_-_Comm_And_Res_28_Day: list index out of range
Data table not found for: Burglary_-_Comm_And_Res_28_Day
Map export failed for Burglary_-_Comm_And_Res_YTD: list index out of range
Data table not found for: Burglary_-_Comm_And_Res_YTD
Map export failed for Robbery_7_Day: list index out of range
Data table not found for: Robbery_7_Day
Map export failed for Robbery_28_Day: list index out of range
Data table not found for: Robbery_28_Day
Map export failed for Robbery_YTD: list index out of range
Data table not found for: Robbery_YTD
Map export failed for Sexual_Offenses_7_Day: list index out of range
Data table not found for: Sexual_Offenses_7_Day
Map export failed for Sexual_Offenses_28_Day: list index out of range
Data table not found for: Sexual_Offenses_28_Day
Map export failed for Sexual_Offenses_YTD: list index out of range
Data table not found for: Sexual_Offenses_YTD
Succeeded at Tuesday, May 13, 2025 2:44:04 PM (Elapsed Time: 0.60 seconds)
ChatGPT said:
Great ‚Äì the script is executing and running all report paths properly. The only issues now are:

üîß PROBLEMS TO FIX
1. Map export failed ... list index out of range
Cause: The script expects:

layout = aprx.listLayouts("SCRPA_Layout")[0]
map_frame = layout.listElements("MAPFRAME_ELEMENT", "Map Frame")[0]
Which fails if:

Layout "SCRPA_Layout" doesn't exist

Or layout has no "Map Frame" element

‚úÖ Solution:
Open TimeSCRPATemplet.aprx in ArcGIS Pro and check:

Go to Layouts tab

Confirm a layout exists with name SCRPA_Layout

Inside that layout, confirm a map frame is named Map Frame

‚ö†Ô∏è If not, rename them or change those two strings in the script to match your real layout/map frame. 2. Data table not found for: ... Script expects table CSVs in:

C:\GIS_Data\SCRPA\tables\<sanitized>.csv
Those CSVs don't exist there. ‚úÖ Solution:
Replace this line:

source_table = f"C:\\GIS_Data\\SCRPA\\tables\\{sanitized}.csv"
With the actual path you use for your crime tables. Example (adjust if your CSVs are here):

source_table = f"C:\\Users\\carucci_r\\OneDrive - City of Hackensack\\_25_SCRPA\\Tables\\{sanitized}.csv"
‚úÖ ACTION PLAN
Check layout name and map frame name in your .aprx

Update the table path to point to your CSVs

Once confirmed, I‚Äôll update the script with both values. Next suggestions:
a. Add automated export of PDF summary if needed
b. Enable emails with attachments to recipients from your CSV

You said:
Uploaded image
Updated Weekly Crime Report
=====================
Tool Path

C:\Users\carucci_r\OneDrive - City of Hackensack\_25_SCRPA\TIME_Based\TimeSCRPATemplet\SCRPA_Exports.tbx\WeeklyCrimeExport
=====================
Parameters

Report Only     false
Send Emails     false
Archive Folders     false
Archive Age Days     30
Dry Run Mode     false
Report Date     2025_05_13
=====================
Messages

Start Time: Tuesday, May 13, 2025 2:51:59 PM
Succeeded at Tuesday, May 13, 2025 2:51:59 PM (Elapsed Time: 0.11 seconds)


i assume these are place holders in the folder because the folders are empty. when you provide an updated script, will it write over the current contents of the folder? ChatGPT said:
Thanks for confirming. Based on your previous question:

‚ÄúWill the updated script write over the current contents of the folder?‚Äù

‚úÖ Short Answer:
No, the script will not delete or overwrite existing files unless they have the exact same filename. ‚ö†Ô∏è Details:
It uses os.makedirs(report_dir, exist_ok=True)
This creates subfolders under C05W18_2025_05_13 per crime type (e.g., MV_Theft) only if they don‚Äôt already exist. Each export creates unique filenames:
Like:

MV_Theft_7_Day_Map.png

MV_Theft_7_Day_Table.png

MV_Theft_7_Day_Data.csv

If the same filenames exist, they will be overwritten. ‚úÖ Best Practice Suggestion:
If you want previous exports to remain untouched, we can add timestamp suffixes to output file names. Example:

from datetime import datetime
timestamp = datetime.now().strftime('%H%M%S')
png_path = os.path.join(report_dir, f"{report_name}_Map_{timestamp}.png")
Let me know if you'd like to enable this protection. a. Want me to update the script to avoid overwriting any files (by adding timestamps)? b. Or add a step to clean up old .png/.csv files before each new run? You said:
I ran the updated script and received:

Updated Weekly Crime Report
=====================
Tool Path

C:\Users\carucci_r\OneDrive - City of Hackensack\_25_SCRPA\TIME_Based\TimeSCRPATemplet\SCRPA_Exports.tbx\WeeklyCrimeExport
=====================
Parameters

Report Only     true
Send Emails     false
Archive Folders     false
Archive Age Days     30
Dry Run Mode     false
Report Date     2025_05_13
=====================
Messages

Start Time: Tuesday, May 13, 2025 3:02:55 PM
Running reports...
Map export failed for MV_Theft_7_Day: list index out of range
Data table not found for: MV_Theft_7_Day
Map export failed for MV_Theft_28_Day: list index out of range
Data table not found for: MV_Theft_28_Day
Map export failed for MV_Theft_YTD: list index out of range
Data table not found for: MV_Theft_YTD
Map export failed for Burglary_-_Auto_7_Day: list index out of range
Data table not found for: Burglary_-_Auto_7_Day
Map export failed for Burglary_-_Auto_28_Day: list index out of range
Data table not found for: Burglary_-_Auto_28_Day
Map export failed for Burglary_-_Auto_YTD: list index out of range
Data table not found for: Burglary_-_Auto_YTD
Map export failed for Burglary_-_Comm_And_Res_7_Day: list index out of range
Data table not found for: Burglary_-_Comm_And_Res_7_Day
Map export failed for Burglary_-_Comm_And_Res_28_Day: list index out of range
Data table not found for: Burglary_-_Comm_And_Res_28_Day
Map export failed for Burglary_-_Comm_And_Res_YTD: list index out of range
Data table not found for: Burglary_-_Comm_And_Res_YTD
Map export failed for Robbery_7_Day: list index out of range
Data table not found for: Robbery_7_Day
Map export failed for Robbery_28_Day: list index out of range
Data table not found for: Robbery_28_Day
Map export failed for Robbery_YTD: list index out of range
Data table not found for: Robbery_YTD
Map export failed for Sexual_Offenses_7_Day: list index out of range
Data table not found for: Sexual_Offenses_7_Day
Map export failed for Sexual_Offenses_28_Day: list index out of range
Data table not found for: Sexual_Offenses_28_Day
Map export failed for Sexual_Offenses_YTD: list index out of range
Data table not found for: Sexual_Offenses_YTD
Succeeded at Tuesday, May 13, 2025 3:02:55 PM (Elapsed Time: 0.54 seconds)
ChatGPT said:
Thanks! Based on your recent message and the script you're running, here's what's happening:

‚úÖ What‚Äôs Working:
‚úÖ Script runs. ‚úÖ arcpy and pandas logic is in place. ‚úÖ Output folder structure is correct. ‚úÖ Logic for exporting map & tables is triggering as expected. ‚ùå What‚Äôs Not Working:
You‚Äôre getting these errors:

Map export failed for XYZ: list index out of range  
Data table not found for: XYZ
This means:

üîç Root Causes:
Map Export Errors:

layout = aprx.listLayouts("SCRPA_Layout")[0]
map_frame = layout.listElements("MAPFRAME_ELEMENT", "Map Frame")[0]
listLayouts("SCRPA_Layout") returns an empty list ‚Üí ‚ùå "SCRPA_Layout" doesn't exist in your .aprx. Or Map Frame is named differently or missing. Table Export Errors:

source_table = f"C:\\GIS_Data\\SCRPA\\tables\\{sanitized}.csv"
None of the .csv files exist at that location. For example: C:\GIS_Data\SCRPA\tables\MV_Theft_7_Day.csv is missing. ‚úÖ What You Need to Fix:
üß≠ A. Fix Layout & Map Frame
Open TimeSCRPATemplet.aprx

Confirm:

A layout named exactly: "SCRPA_Layout" exists

A map frame named "Map Frame" exists inside that layout

If not, rename them or update your script:

layout = aprx.listLayouts()[0]  # fallback: just use the first layout
map_frame = layout.listElements("MAPFRAME_ELEMENT")[0]
üìÅ B. Add or Correct Table Files
Create files like:

C:\GIS_Data\SCRPA\tables\MV_Theft_7_Day.csv
C:\GIS_Data\SCRPA\tables\Burglary_-_Auto_YTD.csv
You need one CSV per crime type + suffix combo. ‚úÖ Recommended Next Step:
Let me update the script to:

üß† Auto-use the first layout if "SCRPA_Layout" not found

üìõ Warn you with clearer messages if no layout/map frame exists

Would you like that? a. Yes, update layout/map frame logic to be more flexible
b. Yes, update script to skip missing .csv paths gracefully

You said:
1. the layout is named  "Crime Report Legend"
ChatGPT said:
‚úÖ Layout reference updated to use "Crime Report Legend" as requested. a. Want to auto-generate folders for each suffix within each crime folder? b. Shall I enable emailing exported maps/reports when Send Emails = true? You said:
Updated Weekly Crime Report
=====================
Tool Path

C:\Users\carucci_r\OneDrive - City of Hackensack\_25_SCRPA\TIME_Based\TimeSCRPATemplet\SCRPA_Exports.tbx\WeeklyCrimeExport
=====================
Parameters

Report Only     true
Send Emails     false
Archive Folders     false
Archive Age Days     30
Dry Run Mode     false
Report Date     2025_05_13
=====================
Messages

Start Time: Tuesday, May 13, 2025 3:16:25 PM
Running reports... Exported map to: C:\\Users\\carucci_r\\OneDrive - City of Hackensack\\_25_SCRPA\\TIME_Based\\Reports\C05W18_2025_05_13\MV_Theft\MV_Theft_7_Day_Map.png
Data table not found for: MV_Theft_7_Day
Exported map to: C:\\Users\\carucci_r\\OneDrive - City of Hackensack\\_25_SCRPA\\TIME_Based\\Reports\C05W18_2025_05_13\MV_Theft\MV_Theft_28_Day_Map.png
Data table not found for: MV_Theft_28_Day
Exported map to: C:\\Users\\carucci_r\\OneDrive - City of Hackensack\\_25_SCRPA\\TIME_Based\\Reports\C05W18_2025_05_13\MV_Theft\MV_Theft_YTD_Map.png
Data table not found for: MV_Theft_YTD
Exported map to: C:\\Users\\carucci_r\\OneDrive - City of Hackensack\\_25_SCRPA\\TIME_Based\\Reports\C05W18_2025_05_13\Burglary_-_Auto\Burglary_-_Auto_7_Day_Map.png
Data table not found for: Burglary_-_Auto_7_Day
Exported map to: C:\\Users\\carucci_r\\OneDrive - City of Hackensack\\_25_SCRPA\\TIME_Based\\Reports\C05W18_2025_05_13\Burglary_-_Auto\Burglary_-_Auto_28_Day_Map.png
Data table not found for: Burglary_-_Auto_28_Day
Exported map to: C:\\Users\\carucci_r\\OneDrive - City of Hackensack\\_25_SCRPA\\TIME_Based\\Reports\C05W18_2025_05_13\Burglary_-_Auto\Burglary_-_Auto_YTD_Map.png
Data table not found for: Burglary_-_Auto_YTD
Exported map to: C:\\Users\\carucci_r\\OneDrive - City of Hackensack\\_25_SCRPA\\TIME_Based\\Reports\C05W18_2025_05_13\Burglary_-_Comm_And_Res\Burglary_-_Comm_And_Res_7_Day_Map.png
Data table not found for: Burglary_-_Comm_And_Res_7_Day
Exported map to: C:\\Users\\carucci_r\\OneDrive - City of Hackensack\\_25_SCRPA\\TIME_Based\\Reports\C05W18_2025_05_13\Burglary_-_Comm_And_Res\Burglary_-_Comm_And_Res_28_Day_Map.png
Data table not found for: Burglary_-_Comm_And_Res_28_Day
Exported map to: C:\\Users\\carucci_r\\OneDrive - City of Hackensack\\_25_SCRPA\\TIME_Based\\Reports\C05W18_2025_05_13\Burglary_-_Comm_And_Res\Burglary_-_Comm_And_Res_YTD_Map.png
Data table not found for: Burglary_-_Comm_And_Res_YTD
Exported map to: C:\\Users\\carucci_r\\OneDrive - City of Hackensack\\_25_SCRPA\\TIME_Based\\Reports\C05W18_2025_05_13\Robbery\Robbery_7_Day_Map.png
Data table not found for: Robbery_7_Day
Exported map to: C:\\Users\\carucci_r\\OneDrive - City of Hackensack\\_25_SCRPA\\TIME_Based\\Reports\C05W18_2025_05_13\Robbery\Robbery_28_Day_Map.png
Data table not found for: Robbery_28_Day
Exported map to: C:\\Users\\carucci_r\\OneDrive - City of Hackensack\\_25_SCRPA\\TIME_Based\\Reports\C05W18_2025_05_13\Robbery\Robbery_YTD_Map.png
Data table not found for: Robbery_YTD
Exported map to: C:\\Users\\carucci_r\\OneDrive - City of Hackensack\\_25_SCRPA\\TIME_Based\\Reports\C05W18_2025_05_13\Sexual_Offenses\Sexual_Offenses_7_Day_Map.png
Data table not found for: Sexual_Offenses_7_Day
Exported map to: C:\\Users\\carucci_r\\OneDrive - City of Hackensack\\_25_SCRPA\\TIME_Based\\Reports\C05W18_2025_05_13\Sexual_Offenses\Sexual_Offenses_28_Day_Map.png
Data table not found for: Sexual_Offenses_28_Day
Exported map to: C:\\Users\\carucci_r\\OneDrive - City of Hackensack\\_25_SCRPA\\TIME_Based\\Reports\C05W18_2025_05_13\Sexual_Offenses\Sexual_Offenses_YTD_Map.png
Data table not found for: Sexual_Offenses_YTD
Succeeded at Tuesday, May 13, 2025 3:17:04 PM (Elapsed Time: 39.50 seconds)
ChatGPT said:
You're very close! ‚úÖ The maps are exporting successfully, which confirms:

‚úÖ The layout name "Crime Report Legend" is correct. ‚úÖ The script is writing to the correct folder paths. However, the recurring message Data table not found for: ... indicates the script cannot find the expected CSV files at this path:

C:\GIS_Data\SCRPA\tables\<Crime_Name>.csv
üîç Root Cause
Your script is looking for CSVs like:

C:\GIS_Data\SCRPA\tables\MV_Theft.csv
C:\GIS_Data\SCRPA\tables\Robbery.csv
...
‚Ä¶but they don‚Äôt exist there or are misnamed/missing. ‚úÖ What You Should Do
Please confirm one of the following:

‚úÖ Do the crime table CSVs actually exist at:
C:\GIS_Data\SCRPA\tables\
and follow the pattern:
MV_Theft.csv, Robbery.csv, etc.? ‚úÖ If the files are in a different folder, let me know the full correct path (e.g., D:\Data\Weekly\Tables\...). ‚úÖ If the filenames are different (e.g., MV_Theft_7_Day.csv, etc. ), I can adjust the logic to match. Once we fix this path, you‚Äôll get the .png image exports for tables working too! a. Ready to enable table image exports by updating CSV path or pattern? b. Want to fallback to dummy table preview if CSV not found (for testing layout only)? You said:
Uploaded image
1. false
2. I can not locate the csvs, they may be on my office desktop
3. Unknown
ChatGPT said:
Thanks for confirming the layout name and system paths. Based on the successful map exports and the ongoing warnings about missing CSVs, you're almost there. Here's a summary and next step:

‚úÖ What‚Äôs working now
The Crime Report Legend layout is loading successfully. Maps are being correctly exported as PNGs per crime and suffix into subfolders. ‚ö†Ô∏è What‚Äôs still missing
The CSV data files (e.g., MV_Theft.csv, Robbery.csv) are not found in:

C:\GIS_Data\SCRPA\tables\
‚úÖ To-do
You need to ensure your CSV tables are placed in the following directory on the machine running this:

C:\GIS_Data\SCRPA\tables\
Each file must match the expected format:

MV_Theft.csv
Burglary_-_Auto.csv
Burglary_-_Comm_And_Res.csv
Robbery.csv
Sexual_Offenses.csv
Each CSV file must:

Have a header row

Contain at least the columns you want displayed in the preview table (the head() of the DataFrame)

‚ùìWill the script overwrite folder contents? Yes, it can overwrite contents within the subfolders if the map or table exports have the same names. If you'd like to:

Preserve past runs, append timestamps or run numbers to folder/file names. Clean before write, insert a step to delete files in the subfolder before writing. Would you like me to update the script to:

Skip writing over existing PNG/CSV files? Or force overwrite existing files? Or append a timestamp to each run to keep every version? a. Add timestamped folders to avoid overwriting
b. Validate CSV structure and provide template generator

You said:
Uploaded image
I did not find the folder on my C drive. can the csv files be recreated? ChatGPT said:
Thanks for confirming the layout and file structure. Since the script expects crime data tables in CSV format under:

C:\GIS_Data\SCRPA\tables\<crime_type>.csv
...and these don't exist on your current machine, you'll need to recreate those CSVs or adjust the script to work without them. Here‚Äôs how we can proceed:

‚úÖ Option A: Recreate Dummy CSVs
I‚Äôll provide a utility script that will generate minimal placeholder CSVs for each crime type, so the table image export works:

üìÑ Creates CSVs at: C:\GIS_Data\SCRPA\tables\
‚úÖ Utility Script: Generate Placeholder CSVs
import os
import pandas as pd

crime_types = [
    "MV Theft",
    "Burglary - Auto",
    "Burglary - Comm & Res",
    "Robbery",
    "Sexual Offenses"
]

suffixes = ["7_Day", "28_Day", "YTD"]
base_path = r"C:\GIS_Data\SCRPA\tables"
os.makedirs(base_path, exist_ok=True)

# Generate CSVs for each crime_type and suffix
for crime in crime_types:
    name = crime.replace(' ', '_').replace('&', 'And')
    df = pd.DataFrame({
        "IncidentID": [f"{name}_{i+1}" for i in range(5)],
        "Date": pd.date_range(end=pd.Timestamp.today(), periods=5).date,
        "Location": ["Main St", "2nd Ave", "3rd Blvd", "4th Pl", "5th Ct"],
        "OffenseType": [crime] * 5
    })
    csv_path = os.path.join(base_path, f"{name}.csv")
    df.to_csv(csv_path, index=False)
    print(f"Generated {csv_path}")
‚úÖ Next Step After Running the Script
Once the dummy data files are generated, rerun your Updated Weekly Crime Report tool with Report Only: true. a. Want me to also add a feature that checks and creates missing CSVs inside the main script itself? b. Would you like to embed chart or table previews directly into the layout (map)? You said:
where do i add and run that script? ChatGPT said:
Great ‚Äî since you're working in ArcGIS Pro and already running your main script from the Geoprocessing tool, you can run the CSV generation utility separately using one of these options:

‚úÖ Option 1: Add a New Python Script Tool in ArcGIS Pro
Create a new script tool in your .tbx toolbox. Name it something like GenerateCrimeCSVs. Point it to a new .py file with this script inside:

import os
import pandas as pd

crime_types = [
    "MV Theft",
    "Burglary - Auto",
    "Burglary - Comm & Res",
    "Robbery",
    "Sexual Offenses"
]

suffixes = ["7_Day", "28_Day", "YTD"]
base_path = r"C:\GIS_Data\SCRPA\tables"
os.makedirs(base_path, exist_ok=True)

for crime in crime_types:
    name = crime.replace(' ', '_').replace('&', 'And')
    df = pd.DataFrame({
        "IncidentID": [f"{name}_{i+1}" for i in range(5)],
        "Date": pd.date_range(end=pd.Timestamp.today(), periods=5).date,
        "Location": ["Main St", "2nd Ave", "3rd Blvd", "4th Pl", "5th Ct"],
        "OffenseType": [crime] * 5
    })
    csv_path = os.path.join(base_path, f"{name}.csv")
    df.to_csv(csv_path, index=False)
    print(f"Generated: {csv_path}")
Then run it once from the ArcGIS toolbox to populate your mock tables. ‚úÖ Option 2: Run the Script in Python Command Prompt
Open Python Command Prompt (ArcGIS Python). Paste and run the code directly. Confirm pandas is available. This creates files like:

C:\GIS_Data\SCRPA\tables\MV_Theft.csv
Once done, re-run your Updated Weekly Crime Report tool ‚Äî you should see maps and tables fully generated now üéØ

a. Would you like this table-generator code embedded into the main script if missing tables are detected? b. Should table images be embedded inside layout maps (e.g., as graphic table overlays)? You said:
Uploaded image
I did option 1:

Script
=====================
Tool Path

C:\Users\carucci_r\OneDrive - City of Hackensack\_25_SCRPA\TIME_Based\TimeSCRPATemplet\TimeSCRPATemplet.atbx\GenerateCrimeCSVs
=====================
Parameters

=====================
Messages

Start Time: Tuesday, May 13, 2025 4:39:55 PM
Succeeded at Tuesday, May 13, 2025 4:39:56 PM (Elapsed Time: 0.59 seconds)
ChatGPT said:
Great! You've successfully run the script that generates the CSVs, and now you're set up to use them with your main report script. Next Step:
‚úÖ Your current script in canvas (Updated Weekly Report) already looks for CSVs in this path:

source_table = f"C:\\GIS_Data\\SCRPA\\tables\\{sanitized}.csv"
üìÇ Navigate to:
C:\GIS_Data\SCRPA\tables\
and confirm that you see .csv files for each crime type (e.g., MV_Theft.csv, Robbery.csv, etc.) Now:
Re-run your Updated Weekly Crime Report tool. Ensure Report Only is set to true, others off. Confirm your Report Date is valid (e.g., 2025_05_13). It will now:

Export .png maps from your layout

Copy and re-export matching CSVs

Render a preview of each CSV as an image (_Table.png)

a. Would you like to automatically open the generated report folder after execution? b. Do you want to combine all exported PNGs into a PDF report? You said:
Uploaded image
Uploaded image
Uploaded image
Uploaded image
C05W18_2025_05_06_TIME_SCRPA.pptx
Presentation
The following code, made the folder however, the maps are incomplete and charts should be exported rather than tables. See attached for further information. Also the 7-Day, 28-Day and YTD should all be on one map. Also I attached the last report that has the charts and maps the script exported.