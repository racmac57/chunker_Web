[IMPORT] os
[IMPORT] datetime
[IMPORT] logging
[FROM IMPORT] from pathlib import Path
[FROM IMPORT] from typing import Optional

[CLASS] SCRPALogger
   Methods: __init__, _setup_logging, log_action, log_info, log_warning, log_error, log_debug, get_log_size, rotate_log
   [Description] Logger class for SCRPA (Statistical Crime Reporting and Police Analytics) operations. Handles lo...
[VARIABLE]: _default_logger

[FUNCTION]: log_action(message, context)
   [Description] Legacy function for backward compatibility with existing code. Args:
        message: The m...

[FUNCTION]: log_crime_analysis(message)
   [Description] Log crime analysis operations....

[FUNCTION]: log_data_export(message)
   [Description] Log data export operations....

[FUNCTION]: log_arcgis_operation(message)
   [Description] Log ArcGIS Pro operations....

[FUNCTION]: log_dashboard_update(message)
   [Description] Log dashboard update operations....

[FUNCTION]: log_error_with_details(message, error)
   [Description] Log errors with exception details....

[MAGIC METHOD]: __init__(self, log_dir, log_filename)
   [Description] Initialize the SCRPA logger. Args:
            log_dir: Custom log directory path. ...

[PRIVATE METHOD]: _setup_logging(self)
   [Description] Set up the logging directory and file....

[FUNCTION]: log_action(self, message, context, level)
   [Description] Log an action with timestamp, context, and message. Args:
            message: The ...

[FUNCTION]: log_info(self, message, context)
   [Description] Log an informational message....

[FUNCTION]: log_warning(self, message, context)
   [Description] Log a warning message....

[FUNCTION]: log_error(self, message, context)
   [Description] Log an error message....

[FUNCTION]: log_debug(self, message, context)
   [Description] Log a debug message....

[FUNCTION]: get_log_size(self)
   [Description] Get the current log file size in bytes....

[FUNCTION]: rotate_log(self, max_size_mb)
   [Description] Rotate log file if it exceeds the maximum size. Args:
            max_size_mb: Maxi...
[VARIABLE]: error_msg
[VARIABLE]: logger
[VARIABLE]: level
[VARIABLE]: valid_levels
[VARIABLE]: max_size_bytes
[VARIABLE]: context
[VARIABLE]: level
[VARIABLE]: timestamp
[VARIABLE]: log_entry
[IMPORT] tempfile
[VARIABLE]: backup_name
[VARIABLE]: backup_path